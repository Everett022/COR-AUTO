/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={8086:function(e,t,n){function r(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",u=n.toStringTag||"@@toStringTag";function c(n,r,o,u){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return a(l,"_invoke",function(n,r,a){var o,u,c,s=0,l=a||[],f=!1,g={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return o=t,u=0,c=e,g.n=n,i}};function d(n,r){for(u=n,c=r,t=0;!f&&s&&!a&&t<l.length;t++){var a,o=l[t],d=g.p,m=o[2];n>3?(a=m===r)&&(c=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=e):o[0]<=d&&((a=n<2&&d<o[1])?(u=0,g.v=r,g.n=o[1]):d<m&&(a=n<3||o[0]>r||r>m)&&(o[4]=n,o[5]=r,g.n=m,u=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,m){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,m),u=l,c=m;(t=u<2?e:c)||!f;){o||(u?u<3?(u>1&&(g.n=-1),d(u,c)):g.n=c:g.v=c);try{if(s=2,o){if(u||(a="next"),t=o[a]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,u<2&&(u=0)}else 1===u&&(t=o.return)&&t.call(o),u<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),u=1);o=e}else if((t=(f=g.n<0)?c:n.call(r,g))!==i)break}catch(t){o=e,u=1,c=t}finally{s=1}}return{value:t,done:f}}}(n,o,u),!0),l}var i={};function s(){}function l(){}function f(){}t=Object.getPrototypeOf;var g=[][o]?t(t([][o]())):(a(t={},o,(function(){return this})),t),d=f.prototype=s.prototype=Object.create(g);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,a(e,u,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=f,a(d,"constructor",f),a(f,"constructor",l),l.displayName="GeneratorFunction",a(f,u,"GeneratorFunction"),a(d),a(d,u,"Generator"),a(d,o,(function(){return this})),a(d,"toString",(function(){return"[object Generator]"})),(r=function(){return{w:c,m:m}})()}function a(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}a=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var u=function(t,n){a(e,t,(function(e){return this._invoke(t,n,e)}))};u("next",0),u("throw",1),u("return",2)}},a(e,t,n,r)}function o(e,t,n,r,a,o,u){try{var c=e[o](u),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,a)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var u=e.apply(t,n);function c(e){o(u,r,a,c,i,"next",e)}function i(e){o(u,r,a,c,i,"throw",e)}c(void 0)}))}}function c(){return i.apply(this,arguments)}function i(){return i=u(r().m((function e(){return r().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=u(r().m((function e(t){return r().w((function(e){for(;;)switch(e.n){case 0:return console.log("Opening settings dialog"),Office.context.ui.displayDialogAsync("https://everett022.github.io/COR-AUTO/orderingSet.html",{height:65,width:85}),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),i.apply(this,arguments)}n.d(t,{O:function(){return c}}),Office.onReady((function(e){e.host,Office.HostType.Excel}))},10825:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,c=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,u=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw u}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return(t=function(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var i=r&&r.prototype instanceof c?r:c,s=Object.create(i.prototype);return l(s,"_invoke",function(n,r,a){var o,c,i,s=0,l=a||[],f=!1,g={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return o=t,c=0,i=e,g.n=n,u}};function d(n,r){for(c=n,i=r,t=0;!f&&s&&!a&&t<l.length;t++){var a,o=l[t],d=g.p,m=o[2];n>3?(a=m===r)&&(i=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=d&&((a=n<2&&d<o[1])?(c=0,g.v=r,g.n=o[1]):d<m&&(a=n<3||o[0]>r||r>m)&&(o[4]=n,o[5]=r,g.n=m,c=0))}if(a||n>1)return u;throw f=!0,r}return function(a,l,m){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,m),c=l,i=m;(t=c<2?e:i)||!f;){o||(c?c<3?(c>1&&(g.n=-1),d(c,i)):g.n=i:g.v=i);try{if(s=2,o){if(c||(a="next"),t=o[a]){if(!(t=t.call(o,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((t=(f=g.n<0)?i:n.call(r,g))!==u)break}catch(t){o=e,c=1,i=t}finally{s=1}}return{value:t,done:f}}}(n,a,o),!0),s}var u={};function c(){}function i(){}function f(){}t=Object.getPrototypeOf;var g=[][r]?t(t([][r]())):(l(t={},r,(function(){return this})),t),d=f.prototype=c.prototype=Object.create(g);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return i.prototype=f,l(d,"constructor",f),l(f,"constructor",i),i.displayName="GeneratorFunction",l(f,a,"GeneratorFunction"),l(d),l(d,a,"Generator"),l(d,r,(function(){return this})),l(d,"toString",(function(){return"[object Generator]"})),(s=function(){return{w:o,m:m}})()}function l(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}l=function(e,t,n,r){if(t)a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var o=function(t,n){l(e,t,(function(e){return this._invoke(t,n,e)}))};o("next",0),o("throw",1),o("return",2)}},l(e,t,n,r)}function f(e,t,n,r,a,o,u){try{var c=e[o](u),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,a)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function u(e){f(o,r,a,u,c,"next",e)}function c(e){f(o,r,a,u,c,"throw",e)}u(void 0)}))}}function d(e){return m.apply(this,arguments)}function m(){return m=g(s().m((function e(t){return s().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=g(s().m((function e(n){return s().w((function(e){for(;;)switch(e.n){case 0:return console.log("Matching data: ",t),Office.context.ui.displayDialogAsync("https://everett022.github.io/COR-AUTO/display.html",{height:65,width:55}),e.n=1,n.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),m.apply(this,arguments)}function y(){return(y=g(s().m((function e(){var t,n,r,o,u,i,l,f,g,d,m,y;return s().w((function(e){for(;;)switch(e.n){case 0:if(t=localStorage.getItem("matchingData"),console.log("Stored Value:",t),t){n=JSON.parse(t),r=document.getElementById("data-output"),(o=Number(localStorage.getItem("currentInventory")))&&!isNaN(o)||(o=0),(u=n.filter((function(e){return e.qty>0&&(e.date||e.fDate)})).map((function(e){return c(c({},e),{},{dateObj:new Date(e.date||e.fDate)})}))).sort((function(e,t){return e.dateObj-t.dateObj})),i=new Set,l=o,f=a(u);try{for(f.s();!(g=f.n()).done;)d=g.value,l>=d.qty&&(m="".concat(d.job,"__").concat(d.dateObj.toISOString()),i.add(m),l-=d.qty)}catch(e){f.e(e)}finally{f.f()}y="<table>\n        <thead>\n            <tr>\n            <th>Item Code</th>\n            <th>Job Number</th>\n            <th>Quantity</th>\n            <th>Start Date</th>\n            </tr>\n        </thead>\n        <tbody>\n        ",n.forEach((function(e){var t,n,r,a,o,u=0===e.qty||""===e.date||null==e.date,c=e.date||e.fDate||"",s=c?new Date(c):null,l=e.job&&s?"".concat(e.job,"__").concat(s.toISOString()):"",f=u?"disabled":"";i.has(l)&&(f+=(f?" ":"")+"covered"),y+="<tr".concat(f?' class="'.concat(f,'"'):"",">\n            <td>").concat(null!==(t=e.code)&&void 0!==t?t:"","</td>\n            <td>").concat(null!==(n=e.job)&&void 0!==n?n:"","</td>\n            <td>").concat(null!==(r=e.qty)&&void 0!==r?r:"","</td>\n            <td>").concat(null!==(a=null!==(o=e.fDate)&&void 0!==o?o:e.date)&&void 0!==a?a:"","</td>\n            </tr>\n        ")})),y+="  </tbody>\n        </table>",r.innerHTML=y}case 1:return e.a(2)}}),e)})))).apply(this,arguments)}n.d(t,{P:function(){return d}}),Office.onReady((function(e){e.host===Office.HostType.Excel&&(window.onload=function(){return y.apply(this,arguments)}())}))},16286:function(e,t,n){e.exports=n.p+"assets/settings.jpeg"},21708:function(e,t,n){e.exports=n.p+"assets/SW.png"},58394:function(e,t,n){e.exports=n.p+"f12a41c31f591815d881.css"},60947:function(e,t,n){e.exports=n.p+"e6cc44e6ae8d58470ecf.js"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){var e=n(10825),t=n(8086);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(r(e)+" is not iterable")}function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=l(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){c=!0,o=e},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw o}}}}function u(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return i(l,"_invoke",function(n,r,a){var o,c,i,s=0,l=a||[],f=!1,g={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return o=t,c=0,i=e,g.n=n,u}};function d(n,r){for(c=n,i=r,t=0;!f&&s&&!a&&t<l.length;t++){var a,o=l[t],d=g.p,m=o[2];n>3?(a=m===r)&&(i=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=d&&((a=n<2&&d<o[1])?(c=0,g.v=r,g.n=o[1]):d<m&&(a=n<3||o[0]>r||r>m)&&(o[4]=n,o[5]=r,g.n=m,c=0))}if(a||n>1)return u;throw f=!0,r}return function(a,l,m){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,m),c=l,i=m;(t=c<2?e:i)||!f;){o||(c?c<3?(c>1&&(g.n=-1),d(c,i)):g.n=i:g.v=i);try{if(s=2,o){if(c||(a="next"),t=o[a]){if(!(t=t.call(o,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((t=(f=g.n<0)?i:n.call(r,g))!==u)break}catch(t){o=e,c=1,i=t}finally{s=1}}return{value:t,done:f}}}(n,a,o),!0),l}var u={};function s(){}function l(){}function f(){}t=Object.getPrototypeOf;var g=[][r]?t(t([][r]())):(i(t={},r,(function(){return this})),t),d=f.prototype=s.prototype=Object.create(g);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,i(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=f,i(d,"constructor",f),i(f,"constructor",l),l.displayName="GeneratorFunction",i(f,a,"GeneratorFunction"),i(d),i(d,a,"Generator"),i(d,r,(function(){return this})),i(d,"toString",(function(){return"[object Generator]"})),(c=function(){return{w:o,m:m}})()}function i(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}i=function(e,t,n,r){if(t)a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var o=function(t,n){i(e,t,(function(e){return this._invoke(t,n,e)}))};o("next",0),o("throw",1),o("return",2)}},i(e,t,n,r)}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,u,c=[],i=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{if(!i&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(s)throw a}}return c}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return f(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t,n,r,a,o,u){try{var c=e[o](u),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,a)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function u(e){g(o,r,a,u,c,"next",e)}function c(e){g(o,r,a,u,c,"throw",e)}u(void 0)}))}}Office.onReady((function(e){e.host===Office.HostType.Excel&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("generate-ordering-report").onclick=function(){return k(w)},document.getElementById("generate-inventory-report").onclick=function(){return k(E)},document.getElementById("start-date").addEventListener("input",J),document.getElementById("end-date").addEventListener("input",J),document.getElementById("order-filtering").addEventListener("change",K),document.getElementById("inventory-filtering").addEventListener("change",Y),document.getElementById("settings-button").onclick=function(){return k(t.O)},setInterval((function(){(function(){return te.apply(this,arguments)})().catch(console.error)}),5e3))}));var m,y,R=[],p=[],h=new Map,v=new Map,O=new Set,C=[],b=[];function w(){return I.apply(this,arguments)}function I(){return I=d(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=d(c().m((function e(t){var n,r;return c().w((function(e){for(;;)switch(e.n){case 0:return j(),e.n=1,t.sync();case 1:if(m=t.workbook.worksheets.add("Ordering"),(y=m.tables.add("A1:G1",!0)).name="OrderingTable",y.getHeaderRowRange().values=[["Case #","Demand","Current Inventory","On Order","Required Amount","Buy or Make","Earliest Start Date"]],y.columns.getItemAt(3).getRange().numberFormat=[["€#,##0.00"]],y.getRange().format.autofitColumns(),y.getRange().format.autofitRows(),n=document.getElementById("start-date").value,r=document.getElementById("end-date").value,n&&r){e.n=2;break}return document.getElementById("message-area").textContent="Please enter the dates",e.a(2);case 2:return document.getElementById("message-area").textContent=" ",G(),e.n=3,t.sync();case 3:return _(),e.n=4,t.sync();case 4:return m.onSelectionChanged.add(V),e.n=5,t.sync();case 5:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),I.apply(this,arguments)}function E(){return S.apply(this,arguments)}function S(){return S=d(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=d(c().m((function e(t){var n,r,a,o,u,i;return c().w((function(e){for(;;)switch(e.n){case 0:return P(),e.n=1,t.sync();case 1:if(n=t.workbook.worksheets.add("Inventory At"),r=n.tables.add("A1:J1",!0),a=t.workbook.worksheets.add("Inventory Request"),o=a.tables.add("A1:D1",!0),r.name="InventoryAtTable",r.style="TableStyleMedium10",o.name="InventoryReadoutTable",o.style="TableStyleMedium10",o.getHeaderRowRange().values=[["Item Code","Inventory Date","Inventory Ref","Inventory Qty"]],r.getHeaderRowRange().values=[["Case #","Demand","Qty MEB","Qty EFW","Total MEB + EFW","On Order","Start Date","Release Date","Qty Needed (MEB)","Notes"]],r.columns.getItemAt(2).getRange().numberFormat=[["€#,##0.00"]],r.getRange().format.autofitColumns(),r.getRange().format.autofitRows(),u=document.getElementById("start-date").value,i=document.getElementById("end-date").value,u&&i){e.n=2;break}return document.getElementById("message-area").textContent="Please enter the dates",e.a(2);case 2:return document.getElementById("message-area").textContent=" ",q(),e.n=3,t.sync();case 3:return D(),e.n=4,t.sync();case 4:return e.n=5,_();case 5:B();case 6:return e.n=7,t.sync();case 7:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),S.apply(this,arguments)}function k(e){return M.apply(this,arguments)}function M(){return(M=d(c().m((function e(t){var n,r;return c().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,t();case 1:e.n=3;break;case 2:e.p=2,r=e.v,(n=document.getElementById("message-area"))&&(n.textContent="Error: ".concat(r.message||r),n.style.color="red",setTimeout((function(){n.textContent="",n.style.color=""}),5e3)),console.error(r);case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function _(){return A.apply(this,arguments)}function A(){return A=d(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=d(c().m((function e(t){var n,r,a,i,s,l,f,g,d,m,y,p,v,O,C,b,w,I,E,S,k,M,_,A,D,x,B,N,j,T,P,F,G,W,q,H,Q,z,J,V,$,K,X,Y,Z,ee,te,ne,re,ae,oe,ue,ce,ie,se,le,fe,ge,de,me,ye,Re,pe,he,ve,Oe,Ce,be,we,Ie,Ee,Se,ke,Me,_e,Ae,De,xe,Be,Ne,je,Te,Pe,Fe,Ue,Le,Ge,We,qe,He,Qe,ze,Je,Ve,$e,Ke,Xe,Ye,Ze,et,tt;return c().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getItem("Inventory"),r=n.getUsedRange().load("values"),a=t.workbook.worksheets.getItem("Dynamic"),i=a.getUsedRange().load("values"),s=t.workbook.worksheets.getItem("Open PO's"),l=s.getUsedRange().load("values"),f=t.workbook.worksheets.getItem("Ordering"),e.n=1,t.sync();case 1:return g=i.values[0],d=g.indexOf("Corrugate"),m=g.indexOf("Number of Corrugate"),y=g.indexOf("Work Center"),p="".concat(U(d),":").concat(U(d)),v="".concat(U(m),":").concat(U(m)),O="".concat(U(y),":").concat(U(y)),C=l.values[0],b=C.indexOf("Item Code"),w=C.indexOf("Outstanding Qty"),I="".concat(U(b),":").concat(U(b)),E="".concat(U(w),":").concat(U(w)),S=r.values[0],k=S.indexOf("Item Code"),M=S.indexOf("Inventory Qty"),_="".concat(U(k),":").concat(U(k)),A="".concat(U(M),":").concat(U(M)),D=t.workbook.worksheets.getItem("Dynamic"),x=D.getRange(v).getUsedRange().load("values"),B=D.getRange(p).getUsedRange().load("values"),N=D.getRange(O).getUsedRange().load("values"),e.n=2,t.sync();case 2:return j=n.getRange(_).getUsedRange().load("values"),T=n.getRange(A).getUsedRange().load("values"),P=t.workbook.worksheets.getItem("Open PO's"),F=P.getRange(I).getUsedRange().load("values"),G=P.getRange(E).getUsedRange().load("values"),e.n=3,t.sync();case 3:W=R.map((function(e){return[e.itemCode]})),q=R.map((function(e){return[e.qty]})),H=L(B.values,x.values),Q=L(W,q),z=L(j.values,T.values),J=L(F.values,G.values),V=new Set([].concat(u(Q.keys()),u(z.keys()),u(J.keys()))),$=[["Case #","Required Amount"]],K=o(V);try{for(K.s();!(X=K.n()).done;)Y=X.value,Z=Q.get(Y)||0,ee=z.get(Y)||0,te=J.get(Y)||0,(ne=Z-ee-te)>0&&$.push([Y,ne])}catch(e){K.e(e)}finally{K.f()}return re=$.map((function(e){return[e[0]]})),f.getRange("A1:A".concat(re.length)).values=re,ae=$.map((function(e){return[e[1]]})),f.getRange("E1:E".concat(ae.length)).values=ae,e.n=4,t.sync();case 4:oe=[["Case #","Remove From Order"]],ue=o(V);try{for(ue.s();!(ce=ue.n()).done;)ie=ce.value,se=Number(H.get(ie))||0,le=Number(J.get(ie))||0,fe=le-se,isNaN(se)||isNaN(le)||String(ie).includes("COR")&&le>se&&oe.push([ie,fe])}catch(e){ue.e(e)}finally{ue.f()}return console.log("Sell these",oe),ge=f.getUsedRange().load("values"),e.n=5,t.sync();case 5:for(de=ge.values,me=[["Earliest Start Date"]],ye=1;ye<de.length;ye++)Re=String(de[ye][0]).trim(),pe=String(h.get(Re))||"No Start Date Established",he=pe.split(" ").slice(0,4).join(" "),me.push([he]);f.getRange("G1:G".concat(me.length)).values=me,ve=$.map((function(e){return e[0]})),Oe=[["Demand"]],Ce=o(ve);try{for(Ce.s();!(be=Ce.n()).done;)we=be.value,(Ie=Q.get(we)||0)>0&&Oe.push([Ie])}catch(e){Ce.e(e)}finally{Ce.f()}Ee=Oe.map((function(e){return[e[0]]})),f.getRange("B1:B".concat(Ee.length)).values=Ee,Se=[["Current Inventory"]],ke=o(ve.slice(1));try{for(ke.s();!(Me=ke.n()).done;)_e=Me.value,Ae=z.get(_e)||0,Se.push([Ae])}catch(e){ke.e(e)}finally{ke.f()}De=Se.map((function(e){return[e[0]]})),f.getRange("C1:C".concat(De.length)).values=De,xe=[["On Order"]],Be=o(ve.slice(1));try{for(Be.s();!(Ne=Be.n()).done;)je=Ne.value,Te=J.get(je)||0,xe.push([Te])}catch(e){Be.e(e)}finally{Be.f()}for(Pe=xe.map((function(e){return[e[0]]})),f.getRange("D1:D".concat(Pe.length)).values=Pe,Fe=new Map,Ue=1;Ue<B.values.length;Ue++)Le=String(B.values[Ue][0]).trim(),Ge=N.values[Ue]?String(N.values[Ue][0]).trim():"",Le&&Ge&&(Fe.has(Le)||Fe.set(Le,new Set),Fe.get(Le).add(Ge));return e.n=6,t.sync();case 6:We=[["Buy or Make"]],qe=o(ve.slice(1));try{for(qe.s();!(He=qe.n()).done;)Qe=He.value,ze=Fe.get(Qe),Je=ze?Array.from(ze).join(", "):"",We.push([Je])}catch(e){qe.e(e)}finally{qe.f()}Ve=We.map((function(e){return[e[0]]})),$e=[["Buy or Make"]],Ke=1;case 7:if(!(Ke<Ve.length)){e.n=9;break}return(Xe=Ve[Ke][0]).includes("40FGAL3A")||Xe.includes("40FGAL3B")||Xe.includes("40FGAL3C")||Xe.includes("40FGSI2A")||Xe.includes("40AIFG2B")?$e.push(["Must Buy"]):Number(ae[Ke][0])>=300?$e.push(["Can Buy"]):$e.push(["Can Make"]),e.n=8,t.sync();case 8:Ke++,e.n=7;break;case 9:return f.getRange("F1:F".concat($e.length)).values=$e,f.getRange("A:G").format.autofitColumns(),f.getRange("A:H").format.horizontalAlignment="Center",f.getRange("A:H").format.verticalAlignment="Center",f.getRange("D:D").numberFormat=[["General"]],f.getRange("A:A").format.columnWidth=150,f.getRange("B:B").format.columnWidth=90,f.getRange("C:C").format.columnWidth=120,f.getRange("D:D").format.columnWidth=90,f.getRange("E:E").format.columnWidth=130,f.getRange("F:F").format.columnWidth=100,f.getRange("B:B").format.columnWidth=130,f.getUsedRange().format.rowHeight=30,f.freezePanes.freezeRows(1),f.getRange("E1:E1").format.fill.color="#BE5014",f.getRange("E1:E1").format.font.color="yellow",Ye=f.getUsedRange(),Ze=Ye.format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight","InsideVertical","InsideHorizontal"].forEach((function(e){Ze.getItem(e).style="Continuous",Ze.getItem(e).weight="Thin",Ze.getItem(e).color="#000000"})),et=Ee.length,tt=f.getRange("E1:E".concat(et)).format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight"].forEach((function(e){tt.getItem(e).style="Continuous",tt.getItem(e).weight="Thick",tt.getItem(e).color="#BE5014"})),e.n=10,t.sync();case 10:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),A.apply(this,arguments)}function D(e){return x.apply(this,arguments)}function x(){return x=d(c().m((function e(t){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=d(c().m((function e(t){var n,r,a,u,i,s,l,f,g,d,m,y,R,h,O,C,b,w,I,E,S,k,M,_,A,D,x,B,N,j,T,P,F,G,W,q,H,Q,z,J,V,$,K,X,Y,Z,ee,te,ne,re,ae,oe,ue,ce,ie,se,le,fe,ge,de,me,ye,Re,pe,he,ve,Oe,Ce,be,we,Ie,Ee,Se,ke,Me,_e,Ae,De,xe,Be,Ne,je,Te,Pe,Fe;return c().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getItem("Inventory"),r=n.getUsedRange().load("values"),a=t.workbook.worksheets.getItem("Dynamic"),u=a.getUsedRange().load("values"),i=t.workbook.worksheets.getItem("Open PO's"),s=i.getUsedRange().load("values"),l=t.workbook.worksheets.getItem("Inventory At"),e.n=1,t.sync();case 1:return f=u.values[0],g=f.indexOf("Corrugate"),d=f.indexOf("Number of Corrugate"),"".concat(U(g),":").concat(U(g)),"".concat(U(d),":").concat(U(d)),m=s.values[0],y=m.indexOf("Item Code"),R=m.indexOf("Outstanding Qty"),h="".concat(U(y),":").concat(U(y)),O="".concat(U(R),":").concat(U(R)),C=r.values[0],b=C.indexOf("Item Code"),w=C.indexOf("Inventory Qty"),I=C.indexOf("Location"),E="".concat(U(b),":").concat(U(b)),S="".concat(U(w),":").concat(U(w)),k="".concat(U(I),":").concat(U(I)),e.n=2,t.sync();case 2:return M=n.getRange(E).getUsedRange().load("values"),_=n.getRange(S).getUsedRange().load("values"),A=n.getRange(k).getUsedRange().load("values"),D=t.workbook.worksheets.getItem("Open PO's"),x=D.getRange(h).getUsedRange().load("values"),B=D.getRange(O).getUsedRange().load("values"),e.n=3,t.sync();case 3:N=p.map((function(e){return[e.itemCode]})),j=p.map((function(e){return[e.qty]})),T=L(N,j),P=[["Case #","Demand"]],F=o(T.keys());try{for(F.s();!(G=F.n()).done;)W=G.value,(q=T.get(W)||0)>0&&P.push([W,q])}catch(e){F.e(e)}finally{F.f()}return e.n=4,t.sync();case 4:for(H=P.map((function(e){return e[0]})),Q=P.map((function(e){return[e[1]]})),console.log("Required Amounts",Q),z=[],J=[],V=0;V<H.length;V++){for($=String(H[V]).trim(),K=!1,X=0;X<M.values.length;X++)Y=String(M.values[X][0]).trim(),Z=String(A.values[X][0]).trim(),ee=Number(_.values[X][0]),$===Y&&(te=Z.includes("MEB"),ne=Z.includes("EFW"),z.push([$,te?ee:0]),J.push([$,ne?ee:0]),K=!0);K||(z.push([$,0]),J.push([$,0]))}return e.n=5,t.sync();case 5:re=L(z.map((function(e){return[e[0]]})),z.map((function(e){return[e[1]]}))),ae=Array.from(re.entries()).map((function(e){return[e[1]]})),oe=L(J.map((function(e){return[e[0]]})),J.map((function(e){return[e[1]]}))),ue=Array.from(oe.entries()).map((function(e){return[e[1]]})),ce=ae.map((function(e,t){return Number(e)+ue[t][0]})),ie=L(x.values,B.values),se=[["On Order"]],le=o(H.slice(1));try{for(le.s();!(fe=le.n()).done;)ge=fe.value,de=ie.get(ge)||0,se.push([de])}catch(e){le.e(e)}finally{le.f()}for(me=[["Earliest Start Date"]],ye=[["Release Date"]],Re=1;Re<H.length;Re++)pe=String(H[Re]).trim(),he=String(v.get(pe))||"No Start Date Established",ve=he.split(" ").slice(0,4).join(" "),me.push([ve]),Oe=new Date(he),isNaN(Oe)?ye.push(["Invalid Release Date"]):(Oe.setDate(Oe.getDate()-10),Ce=Oe.toDateString(),ye.push([Ce]));for(be=Q.slice(1).map((function(e,t){return Number(e)-ae[t]})),(we=[]).push({caseNumber:"Case #",demand:"Demand",mebQty:"Qty MEB",efwQty:"Qty EFW",totalQty:"Total MEB + EFW",onOrder:"On Order",startDate:"Start Date",releaseDate:"Release Date",qtyNeeded:"Qty Needed (MEB)",notes:"Notes"}),Ie=0;Ie<H.slice(1).length;Ie++)be[Ie]>0&&we.push({caseNumber:H[Ie+1],demand:Q[Ie+1][0],mebQty:ae[Ie][0],efwQty:ue[Ie][0],totalQty:ce[Ie],onOrder:se[Ie+1][0],startDate:me[Ie+1][0],releaseDate:ye[Ie+1][0],qtyNeeded:be[Ie],notes:""});return we.length>1&&(Ee=we.map((function(e){return[e.caseNumber]})),Se=we.map((function(e){return[e.demand]})),ke=we.map((function(e){return[e.mebQty]})),Me=we.map((function(e){return[e.efwQty]})),_e=we.map((function(e){return[e.totalQty]})),Ae=we.map((function(e){return[e.onOrder]})),De=we.map((function(e){return[e.startDate]})),xe=we.map((function(e){return[e.releaseDate]})),Be=we.map((function(e){return[e.qtyNeeded]})),Ne=we.map((function(e){return[e.notes]})),l.getRange("A1:A".concat(Ee.length)).values=Ee,l.getRange("B1:B".concat(Se.length)).values=Se,l.getRange("C1:C".concat(ke.length)).values=ke,l.getRange("D1:D".concat(Me.length)).values=Me,l.getRange("E1:E".concat(_e.length)).values=_e,l.getRange("F1:F".concat(Ae.length)).values=Ae,l.getRange("G1:G".concat(De.length)).values=De,l.getRange("H1:H".concat(xe.length)).values=xe,l.getRange("I1:I".concat(Be.length)).values=Be,l.getRange("J1:J".concat(Ne.length)).values=Ne),e.n=6,t.sync();case 6:return l.getRange("A:J").format.autofitColumns(),l.getRange("A:J").format.horizontalAlignment="Center",l.getRange("A:J").format.verticalAlignment="Center",l.getRange("C:C").numberFormat=[["General"]],l.getRange("A:A").format.columnWidth=120,l.getRange("B:B").format.columnWidth=70,l.getRange("C:C").format.columnWidth=70,l.getRange("D:D").format.columnWidth=70,l.getRange("E:E").format.columnWidth=100,l.getRange("F:F").format.columnWidth=75,l.getRange("G:G").format.columnWidth=90,l.getRange("H:H").format.columnWidth=90,l.getRange("I:I").format.columnWidth=130,l.getRange("J:J").format.columnWidth=150,l.getUsedRange().format.rowHeight=20,l.freezePanes.freezeRows(1),l.getRange("I1:I1").format.fill.color="#00008B",l.getRange("I1:I1").format.font.color="yellow",je=l.getUsedRange(),Te=je.format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight","InsideVertical","InsideHorizontal"].forEach((function(e){Te.getItem(e).style="Continuous",Te.getItem(e).weight="Thin",Te.getItem(e).color="#000000"})),Pe=we.length,Fe=l.getRange("I1:I".concat(Pe)).format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight"].forEach((function(e){Fe.getItem(e).style="Continuous",Fe.getItem(e).weight="Thick",Fe.getItem(e).color="#00008B"})),e.n=7,t.sync();case 7:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),x.apply(this,arguments)}function B(){return N.apply(this,arguments)}function N(){return N=d(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=d(c().m((function e(t){var n,r,a,u,i,l,f,g,d,m,y,R,p,h,v,O,C,b,w,I,E,S,k,M,_,A,D,x,B,N,j,T,P,F,L,G,W,q,H,Q,J,V,$,K,X,Y,Z,te,ne,re,ae,oe,ue,ce,ie,se,le,fe,ge,de,me,ye,Re,pe,he;return c().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getItem("Inventory At"),r=n.getUsedRange().load("values"),a=t.workbook.worksheets.getItem("Inventory"),u=a.getUsedRange().load("values"),i=t.workbook.worksheets.getItem("Inventory Request"),e.n=1,t.sync();case 1:return l=r.values[0],f=l.indexOf("Case #"),g=l.indexOf("Qty Needed (MEB)"),d=l.indexOf("Qty EFW"),m="".concat(U(f),":").concat(U(f)),y="".concat(U(g),":").concat(U(g)),R="".concat(U(d),":").concat(U(d)),p=u.values[0],h=p.indexOf("Item Code"),v=p.indexOf("Inventory Date"),O=p.indexOf("Inventory Ref"),C=p.indexOf("Inventory Qty"),b=p.indexOf("Location"),w="".concat(U(h),":").concat(U(h)),I="".concat(U(v),":").concat(U(v)),E="".concat(U(O),":").concat(U(O)),S="".concat(U(C),":").concat(U(C)),k="".concat(U(b),":").concat(U(b)),e.n=2,t.sync();case 2:return M=n.getRange(m).getUsedRange().load("values"),_=n.getRange(y).getUsedRange().load("values"),A=n.getRange(R).getUsedRange().load("values"),D=a.getRange(w).getUsedRange().load("values"),x=a.getRange(I).getUsedRange().load("values"),B=a.getRange(E).getUsedRange().load("values"),N=a.getRange(S).getUsedRange().load("values"),j=a.getRange(k).getUsedRange().load("values"),e.n=3,t.sync();case 3:for(T=[],P=1;P<M.values.length;P++)F=Number(_.values[P][0]),L=Number(A.values[P][0]),F>300&&L>0&&T.push({itemCode:String(M.values[P][0]).trim(),qtyNeeded:F});for(G=new Map,W=1;W<D.values.length;W++)q=String(D.values[W][0]).trim(),H=x.values[W]?String(x.values[W][0]).trim():"",(Q=z(H)).setHours(0,0,0,0),J=ee(Q),V=j.values[W]?String(j.values[W][0]).trim():"",$=B.values[W]?String(B.values[W][0]).trim():"",K=Number(N.values[W][0]),V.includes("EFW")&&q&&!isNaN(K)&&K>0&&(G.has(q)||G.set(q,[]),G.get(q).push({date:J,ref:$,qty:K}));X=o(G);try{for(X.s();!(Y=X.n()).done;)(Z=s(Y.value,2))[0],Z[1].sort((function(e,t){return new Date(e.date)-new Date(t.date)}))}catch(e){X.e(e)}finally{X.f()}te=[["Item Code","Inventory Date","Inventory Ref","Inventory Qty"]],ne=0,re=T;case 4:if(!(ne<re.length)){e.n=13;break}if(ae=re[ne],oe=ae.itemCode,ue=ae.qtyNeeded,!G.has(oe)){e.n=12;break}ce=G.get(oe),ie=0,se=o(ce),e.p=5,se.s();case 6:if((le=se.n()).done){e.n=9;break}if(fe=le.value,!(ie>=ue)){e.n=7;break}return e.a(3,9);case 7:te.push([oe,fe.date,fe.ref,fe.qty]),ie+=fe.qty;case 8:e.n=6;break;case 9:e.n=11;break;case 10:e.p=10,he=e.v,se.e(he);case 11:return e.p=11,se.f(),e.f(11);case 12:ne++,e.n=4;break;case 13:return te.length>1&&(ge=te.map((function(e){return[e[0]]})),de=te.map((function(e){return[e[1]]})),me=te.map((function(e){return[e[2]]})),ye=te.map((function(e){return[e[3]]})),i.getRange("A1:A".concat(ge.length)).values=ge,i.getRange("B1:B".concat(de.length)).values=de,i.getRange("C1:C".concat(me.length)).values=me,i.getRange("D1:D".concat(ye.length)).values=ye),e.n=14,t.sync();case 14:return i.getRange("A:D").format.autofitColumns(),i.getRange("A:D").format.horizontalAlignment="Center",i.getRange("A:D").format.verticalAlignment="Center",i.getRange("A:A").format.columnWidth=120,i.getRange("B:B").format.columnWidth=100,i.getRange("C:C").format.columnWidth=100,i.getRange("D:D").format.columnWidth=100,i.getUsedRange().format.rowHeight=20,i.freezePanes.freezeRows(1),Re=i.getUsedRange(),pe=Re.format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight","InsideVertical","InsideHorizontal"].forEach((function(e){pe.getItem(e).style="Continuous",pe.getItem(e).weight="Thin",pe.getItem(e).color="#000000"})),e.n=15,t.sync();case 15:return e.a(2)}}),e,null,[[5,10,11,12]])})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),N.apply(this,arguments)}function j(){return T.apply(this,arguments)}function T(){return T=d(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=d(c().m((function e(t){return c().w((function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.getItemOrNullObject("Ordering").delete(),R=[],h.clear(),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),T.apply(this,arguments)}function P(){return F.apply(this,arguments)}function F(){return F=d(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=d(c().m((function e(t){var n;return c().w((function(e){for(;;)switch(e.n){case 0:return(n=t.workbook.worksheets).getItemOrNullObject("Inventory At").delete(),n.getItemOrNullObject("Inventory Request").delete(),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),F.apply(this,arguments)}function U(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}function L(e,t){for(var n=new Map,r=1;r<e.length;r++){var a=e[r][0],o=Number(t[r][0]);a&&!isNaN(o)&&n.set(a,(n.get(a)||0)+o)}return n}function G(){return W.apply(this,arguments)}function W(){return W=d(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=d(c().m((function e(t){var n,r,a,u,i,s,l,f,g,d,m,y,p,v,O,b,w,I,E,S,k,M,_,A,D,x,B,N,j,T,P,F,L,G,W,q,H,J;return c().w((function(e){for(;;)switch(e.n){case 0:return n=document.getElementById("start-date").value,r=document.getElementById("end-date").value,a=Q(n),u=Q(r),i=t.workbook.worksheets.getItem("Dynamic"),s=i.getUsedRange().load("values"),e.n=1,t.sync();case 1:return l=s.values[0],f=l.indexOf("Corrugate"),g=l.indexOf("Planned Start"),d=l.indexOf("Number of Corrugate"),m=l.indexOf("Order Number"),y="".concat(U(g),":").concat(U(g)),p="".concat(U(d),":").concat(U(d)),v="".concat(U(f),":").concat(U(f)),O="".concat(U(m),":").concat(U(m)),b=t.workbook.worksheets.getItem("Dynamic"),w=b.getRange(v).getUsedRange().load("values"),I=b.getRange(p).getUsedRange().load("values"),E=i.getRange(y).getUsedRange().load("values"),S=i.getRange(O).getUsedRange().load("values"),e.n=2,t.sync();case 2:for(k=new Map,M=1;M<w.values.length;M++)_=String(w.values[M][0]).trim(),A=E.values[M]?String(E.values[M][0]).trim():"",(D=z(A)).setHours(0,0,0,0),x=String(S.values[M][0]).trim(),B=Number(I.values[M][0]),_&&D>=a&&D<=u&&(!k.has(x)||D>k.get(x).date)&&k.set(x,{itemCode:_,qty:B,date:D,job:x});R=Array.from(k.values()),h.clear(),N=o(R);try{for(N.s();!(j=N.n()).done;)T=j.value,P=T.itemCode,F=T.date,(!h.has(P)||F<h.get(P))&&h.set(P,F)}catch(e){N.e(e)}finally{N.f()}return R.sort((function(e,t){return e.date-t.date})),e.n=3,t.sync();case 3:for(L=1;L<w.values.length;L++)G=String(w.values[L][0]).trim(),W=E.values[L]?String(E.values[L][0]).trim():"",(q=z(W)).setHours(0,0,0,0),H=String(S.values[L][0]).trim(),J=Number(I.values[L][0]),G&&C.push({itemCode:G,qty:J,job:H,date:q});case 4:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),W.apply(this,arguments)}function q(){return H.apply(this,arguments)}function H(){return H=d(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=d(c().m((function e(t){var n,r,a,u,i,s,l,f,g,d,m,y,R,h,O,C,b,w,I,E,S,k,M,_,A,D,x,B,N,j,T,P;return c().w((function(e){for(;;)switch(e.n){case 0:return n=document.getElementById("start-date").value,r=document.getElementById("end-date").value,a=Q(n),u=Q(r),i=t.workbook.worksheets.getItem("Dynamic"),s=i.getUsedRange().load("values"),e.n=1,t.sync();case 1:return l=s.values[0],f=l.indexOf("Corrugate"),g=l.indexOf("Planned Start"),d=l.indexOf("Number of Corrugate"),m=l.indexOf("Order Number"),y="".concat(U(g),":").concat(U(g)),R="".concat(U(d),":").concat(U(d)),h="".concat(U(f),":").concat(U(f)),O="".concat(U(m),":").concat(U(m)),C=t.workbook.worksheets.getItem("Dynamic"),b=C.getRange(h).getUsedRange().load("values"),w=C.getRange(R).getUsedRange().load("values"),I=i.getRange(y).getUsedRange().load("values"),E=i.getRange(O).getUsedRange().load("values"),e.n=2,t.sync();case 2:for(S=new Map,k=1;k<b.values.length;k++)M=String(b.values[k][0]).trim(),_=I.values[k]?String(I.values[k][0]).trim():"",(A=z(_)).setHours(0,0,0,0),D=String(E.values[k][0]).trim(),x=Number(w.values[k][0]),M&&A>=a&&A<=u&&(!S.has(D)||A>S.get(D).date)&&S.set(D,{itemCode:M,qty:x,date:A,job:D});p=Array.from(S.values()),v.clear(),B=o(p);try{for(B.s();!(N=B.n()).done;)j=N.value,T=j.itemCode,P=j.date,(!v.has(T)||P<v.get(T))&&v.set(T,P)}catch(e){B.e(e)}finally{B.f()}return p.sort((function(e,t){return e.date-t.date})),e.n=3,t.sync();case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),H.apply(this,arguments)}function Q(e){var t=s(e.split("-").map(Number),3),n=t[0],r=t[1],a=t[2];return new Date(n,r-1,a)}function z(e){var t=new Date(86400*(e-25569)*1e3);return new Date(t.getTime()+6e4*t.getTimezoneOffset())}function J(){var e=document.getElementById("start-date").value,t=document.getElementById("end-date").value;e&&t&&(document.getElementById("message-area").textContent="")}function V(e){return $.apply(this,arguments)}function $(){return $=d(c().m((function t(n){return c().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,Excel.run(function(){var t=d(c().m((function t(r){var o,u,i,s,l,f,g,d,m,y,R,p,v,w,I,E,S;return c().w((function(t){for(;;)switch(t.n){case 0:return o=r.workbook.worksheets.getItem("Ordering"),(u=o.getRange(n.address)).load(["columnIndex","values","address"]),t.n=1,r.sync();case 1:if(console.log("Index Number",u.columnIndex),O.clear(),0!=u.columnIndex){t.n=9;break}return b.length=0,i=u.values[0],s=C.map((function(e){return[e.itemCode]})),l=C.map((function(e){return[e.job]})),f=C.map((function(e){return[e.qty]})),g=C.map((function(e){return[e.date]})),d=o.tables.getItem("OrderingTable"),m=d.getDataBodyRange().load("values"),y=d.getHeaderRowRange().load("values"),t.n=2,r.sync();case 2:R=y.values[0],p=R.indexOf("Case #"),v=R.indexOf("Current Inventory"),w=0,I=0;case 3:if(!(I<m.values.length)){t.n=5;break}if(String(m.values[I][p]).trim()!==i[0]){t.n=4;break}return w=Number(m.values[I][v])||0,t.a(3,5);case 4:I++,t.n=3;break;case 5:localStorage.setItem("currentInventory",w),E=c().m((function e(){var t,n,r,a,o,u,d;return c().w((function(e){for(;;)switch(e.n){case 0:t=s[S][0],n=l[S][0],r=f[S][0],a=g[S][0],o=ee(a),i==t&&(O.has(n)?(u=h.get(t),-1!==(d=b.findIndex((function(e){return e.job===n&&e.code===t})))&&(b[d].date=u)):(b.push({code:t,job:n,qty:r,fDate:o,date:a}),O.add(n)));case 1:return e.a(2)}}),e)})),S=0;case 6:if(!(S<s.length)){t.n=8;break}return t.d(a(E()),7);case 7:S++,t.n=6;break;case 8:console.log("intial finding of Matching Data",b),(0,e.P)([].concat(b)),b.sort((function(e,t){return e.date-t.date})),localStorage.setItem("matchingData",JSON.stringify(b)),t.n=10;break;case 9:console.log("Not in range");case 10:return t.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:return t.a(2)}}),t)}))),$.apply(this,arguments)}function K(){return X.apply(this,arguments)}function X(){return X=d(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=d(c().m((function e(t){var n,r,a,o,u,i,s,l,f,g,d,m,y,R,p,h;return c().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getItem("Ordering"),r=n.tables.getItem("OrderingTable"),a=r.columns.getItem("Required Amount").filter,o=r.columns.getItem("Buy or Make").filter,u={CORS522_DW:180,"CORCTD0033A-R2":300,"COR2503503R0 RDC":250,"COR2320-4731":350,COR16M006405:350,"COR6064-RDC":445,CORM30402_C:310,"CORM37238 FLUTED DIV":500,CORM30403_C:250,"CORM39142-R1":250,CORM37912:300,CORX14107:300,"COR2320-4819-R1":300,"COR2320-4658-R1":250,COR17M001501:300,COR2320_5453:300,"COR2320-1840-R1":300,"COR2320-5573":400,COR2320_5575_R1:349,COR2320_5455:300,"COR2866 RDC":250,"COR6062 RDC":250,COR2320_5635:250,"COR6070 RDC":250,CORM33989_H_R2:283,CORMPS13185:250,COR18M020101:400,CORX14151_B:250,COR11707_R1:250,CORM38150_R1:250,COR2320_5906:199,COR17M013701_R1:197,"COR5537 PAD":273,CORM36590_ERECTED_R2:250,CORF170286A9:340,"CORF170287A7-R1":307,CORF170313A6:274,COR6052:250,COR2306R0:285,CORM37798_C_R1:185,COR2320_6830_R1:325,COR19M001713:300,"CORERECTOR-DW":207,COR19M001712_R1:192,CORMPS13113C_R1:200,CORL9466A4_M:258,COR2349R2_R1:300,CORMPS13182A_R1:300,CORDRF_L8916A1:210,COR19M001702_R1:404,CORL10648A2:300,CORDRF_6171_A:257,COR132790_2i:264,CORDRF_2037:271,CORDRF_2232:300,COR2251R0_R1:300,CORM38149_R1:375,COR19M012303:375,COR19M012304:305,COR20M023301:300,COR20M007911:186,"CORM34795_NO INSERT HSC LID":975,"CORM34795_NO INSERT HSC":975,COR20M018813:201,COR20M018814:278,CORDRF_2884_B:350,CORDRF_L9681A2:218,COR20M018815_R1:186,"COR15NF011001-R1":277,COR20M026410_R1:332,COR2320_5691:305,"COR16NF0805.03":305,COR2533504A_R1:320,COR16M006404_R1:269,COR18M010901:315,COR20M018812:257,COR18M025708:325,"CORM37238 GLORD SLEEVE_R1":275,CORABBOTT_CAP:138,CORABBOTT_SLV:109,COR19M010308:325,COR2320_7148_R2:263,COR16M006402:288,COR18M005551_R2:367,COR21M022706:323,COR17M017101_R1:227,CORM36342:200,COR19M019402_R1:304,COR16M006403:244,COR20M026401_R1:350,COR20M026402:363,COR20M026418:237,"COR18M005551_R3 NR":350,COR20M016311_R3:216,"CORM34795 RSC":385,CORM38164:450,COR19M019401_R1:300,COR19M019402_R2:300,CORM34084_A:188,COR2320_6257_R2:303,COR18M000117:202,CORM21854_A:340,COR2320_5582_R1:375,COR21M012001:417,COR16M002106:330,COR16M006401_R1:282,COR16M000901_R3:238,COR17M022101_R2:223,CORM41161_B:297,COR23M012203:261,CORL14795A1:203,CORL9486A1:279,COR18M025707_R2:265,CORF210335A4:296,"COR23LG0002.01":316,COR23M016803:300,CORL11558A4_M:272,CORM33618_B:241,"COR17CL0236.03":350,CORCSK11804A:282,"TB008-01":500,"T22925-5":800,"CORM37238 CAP":154,CORCSK11317B:221,CORL12394A1:266,CORMPS13215C:231,COR13442M:330,"COR21LG0020.01":305,CORMPS13117J:200,CORM38149_R2:245,CORM34795_INSERT_48:768,CORL14798A1:191,"COR20PF0474.02":315,COR16M002105_R1:350,"COR21LG0002.01":200,"CORCSK12007.02_R1":315,COR22M023719:283,CORMPS13048:340,CORMPS13150:405,COR16M006405_R1:256,COR17M027920_R2:340,CORM34795_INSERT_48_R1:625,COR23M014207:310,"CORM33393_E ERECTED":187,CORM26788_C_R2:276,COR20M017216:195,"COR22PF0925.07":347,CORMPS13145B:198,"COR22PF0834.01_R1":264,"COR24LG0016.04":313,"COR24LG0016.02_R1":334,"COR24LG0007.01":261,CORL9184A1_R1:349,COR22M009502_R1:295,"COR22PF0924.07":301,COR17M017101_R3:349,COR22M009501:296,COR22M009503:186,CORDRF_L9680A3:209,CORMPS13150_R1:370,CORMPS13004:465,COR22M009501_R1:292},e.n=1,t.sync();case 1:h=document.getElementById("order-filtering").value,e.n="Intial"===h?2:"cor-minimum"===h?3:"over-300"===h?6:"Must-buy"===h?7:"Can-buy"===h?8:"Can-make"===h?9:10;break;case 2:return console.log("no changes made"),a.clear(),o.clear(),r.columns.getItem("Case #").filter.clear(),e.a(3,11);case 3:return a.clear(),o.clear(),i=r.getDataBodyRange().load("values"),e.n=4,t.sync();case 4:return s=r.getHeaderRowRange().load("values"),e.n=5,t.sync();case 5:for(l=s.values[0],f=l.indexOf("Case #"),g=l.indexOf("Required Amount"),d=[],m=0;m<i.values.length;m++)y=String(i.values[m][f]).trim(),R=Number(i.values[m][g]),void 0!==(p=u[y])&&R>=p&&d.push(y);return r.columns.getItem("Case #").filter.applyValuesFilter(d),e.a(3,11);case 6:return a.clear(),o.clear(),r.columns.getItem("Case #").filter.clear(),a.applyCustomFilter(">=300"),e.a(3,11);case 7:return a.clear(),o.clear(),r.columns.getItem("Case #").filter.clear(),o.applyValuesFilter(["Must Buy"]),e.a(3,11);case 8:return a.clear(),o.clear(),r.columns.getItem("Case #").filter.clear(),o.applyValuesFilter(["Can Buy"]),e.a(3,11);case 9:return a.clear(),o.clear(),r.columns.getItem("Case #").filter.clear(),o.applyValuesFilter(["Can Make"]),e.a(3,11);case 10:return console.log("No valid filter selected"),e.a(3,11);case 11:return e.n=12,t.sync();case 12:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),X.apply(this,arguments)}function Y(){return Z.apply(this,arguments)}function Z(){return Z=d(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=d(c().m((function e(t){var n,r,a,o;return c().w((function(e){for(;;)switch(e.n){case 0:n=t.workbook.worksheets.getItem("Inventory At"),r=n.tables.getItem("InventoryAtTable"),a=r.columns.getItem("Qty Needed (MEB)").filter,o=document.getElementById("inventory-filtering").value,e.n="Intial case"===o?1:"over-300"===o?2:3;break;case 1:return console.log("no changes made"),a.clear(),e.a(3,4);case 2:return a.clear(),a.applyCustomFilter(">=300"),e.a(3,4);case 3:return console.log("No valid filter selected"),e.a(3,4);case 4:return e.n=5,t.sync();case 5:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),Z.apply(this,arguments)}function ee(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-")}function te(){return te=d(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=d(c().m((function e(t){var n,r,u,i,s,l;return c().w((function(e){for(;;)switch(e.n){case 0:return(n=t.workbook.worksheets).load("items/name"),e.n=1,t.sync();case 1:r=n.items.filter((function(e){return["Sheet1","Sheet2","Sheet3"].includes(e.name)})),u=o(r),e.p=2,s=c().m((function e(){var r,a,o,u,s,l,f;return c().w((function(e){for(;;)switch(e.n){case 0:return r=i.value,(a=n.getItem(r.name)).load("name"),e.n=1,t.sync();case 1:return(o=a.getUsedRangeOrNullObject()).load("values"),e.n=2,t.sync();case 2:if(o.values&&0!==o.values.length){e.n=3;break}return e.a(2,1);case 3:if(u=o.values[0].map((function(e){return String(e).trim().toLowerCase()})),s=null,u.includes("item code")&&u.includes("inventory qty")&&u.includes("location")&&u.includes("inventory date")?s="INVENTORY":u.includes("work center")&&u.includes("planned start")&&u.includes("corrugate")&&u.includes("number of corrugate")?s="DYNAMIC":u.includes("item code")&&u.includes("outstanding qty")&&(s="OPEN PO'S"),!s||a.name===s){e.n=4;break}if(n.items.some((function(e){return e.name===s}))){for(l=2,f="".concat(s," (").concat(l,")");n.items.some((function(e){return e.name===f}));)l++,f="".concat(s," (").concat(l,")");a.name=f}else a.name=s;return e.n=4,t.sync();case 4:return e.a(2)}}),e)})),u.s();case 3:if((i=u.n()).done){e.n=6;break}return e.d(a(s()),4);case 4:if(!e.v){e.n=5;break}return e.a(3,5);case 5:e.n=3;break;case 6:e.n=8;break;case 7:e.p=7,l=e.v,u.e(l);case 8:return e.p=8,u.f(),e.f(8);case 9:return e.a(2)}}),e,null,[[2,7,8,9]])})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),te.apply(this,arguments)}}(),new URL(n(58394),n.b),new URL(n(16286),n.b),new URL(n(21708),n.b),new URL(n(60947),n.b)}();
//# sourceMappingURL=taskpane.js.map