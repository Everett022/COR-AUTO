/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={8086:function(e,t,n){function r(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",u=n.toStringTag||"@@toStringTag";function c(n,r,a,u){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return o(l,"_invoke",function(n,r,o){var a,u,c,s=0,l=o||[],f=!1,g={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,u=0,c=e,g.n=n,i}};function d(n,r){for(u=n,c=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=g.p,m=a[2];n>3?(o=m===r)&&(c=a[(u=a[4])?5:(u=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(u=0,g.v=r,g.n=a[1]):d<m&&(o=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,g.n=m,u=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,m){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,m),u=l,c=m;(t=u<2?e:c)||!f;){a||(u?u<3?(u>1&&(g.n=-1),d(u,c)):g.n=c:g.v=c);try{if(s=2,a){if(u||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,u<2&&(u=0)}else 1===u&&(t=a.return)&&t.call(a),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);a=e}else if((t=(f=g.n<0)?c:n.call(r,g))!==i)break}catch(t){a=e,u=1,c=t}finally{s=1}}return{value:t,done:f}}}(n,a,u),!0),l}var i={};function s(){}function l(){}function f(){}t=Object.getPrototypeOf;var g=[][a]?t(t([][a]())):(o(t={},a,(function(){return this})),t),d=f.prototype=s.prototype=Object.create(g);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,o(e,u,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=f,o(d,"constructor",f),o(f,"constructor",l),l.displayName="GeneratorFunction",o(f,u,"GeneratorFunction"),o(d),o(d,u,"Generator"),o(d,a,(function(){return this})),o(d,"toString",(function(){return"[object Generator]"})),(r=function(){return{w:c,m:m}})()}function o(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}o=function(e,t,n,r){if(t)a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var u=function(t,n){o(e,t,(function(e){return this._invoke(t,n,e)}))};u("next",0),u("throw",1),u("return",2)}},o(e,t,n,r)}function a(e,t,n,r,o,a,u){try{var c=e[a](u),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var u=e.apply(t,n);function c(e){a(u,r,o,c,i,"next",e)}function i(e){a(u,r,o,c,i,"throw",e)}c(void 0)}))}}function c(){return i.apply(this,arguments)}function i(){return i=u(r().m((function e(){return r().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=u(r().m((function e(t){return r().w((function(e){for(;;)switch(e.n){case 0:return console.log("Opening settings dialog"),Office.context.ui.displayDialogAsync("https://localhost:3000/orderingSet.html",{height:65,width:85}),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),i.apply(this,arguments)}n.d(t,{O:function(){return c}}),Office.onReady((function(e){e.host,Office.HostType.Excel}))},10825:function(e,t,n){function r(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",u=n.toStringTag||"@@toStringTag";function c(n,r,a,u){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return o(l,"_invoke",function(n,r,o){var a,u,c,s=0,l=o||[],f=!1,g={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,u=0,c=e,g.n=n,i}};function d(n,r){for(u=n,c=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=g.p,m=a[2];n>3?(o=m===r)&&(c=a[(u=a[4])?5:(u=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(u=0,g.v=r,g.n=a[1]):d<m&&(o=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,g.n=m,u=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,m){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,m),u=l,c=m;(t=u<2?e:c)||!f;){a||(u?u<3?(u>1&&(g.n=-1),d(u,c)):g.n=c:g.v=c);try{if(s=2,a){if(u||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,u<2&&(u=0)}else 1===u&&(t=a.return)&&t.call(a),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);a=e}else if((t=(f=g.n<0)?c:n.call(r,g))!==i)break}catch(t){a=e,u=1,c=t}finally{s=1}}return{value:t,done:f}}}(n,a,u),!0),l}var i={};function s(){}function l(){}function f(){}t=Object.getPrototypeOf;var g=[][a]?t(t([][a]())):(o(t={},a,(function(){return this})),t),d=f.prototype=s.prototype=Object.create(g);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,o(e,u,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=f,o(d,"constructor",f),o(f,"constructor",l),l.displayName="GeneratorFunction",o(f,u,"GeneratorFunction"),o(d),o(d,u,"Generator"),o(d,a,(function(){return this})),o(d,"toString",(function(){return"[object Generator]"})),(r=function(){return{w:c,m:m}})()}function o(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}o=function(e,t,n,r){if(t)a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var u=function(t,n){o(e,t,(function(e){return this._invoke(t,n,e)}))};u("next",0),u("throw",1),u("return",2)}},o(e,t,n,r)}function a(e,t,n,r,o,a,u){try{var c=e[a](u),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var u=e.apply(t,n);function c(e){a(u,r,o,c,i,"next",e)}function i(e){a(u,r,o,c,i,"throw",e)}c(void 0)}))}}function c(e){return i.apply(this,arguments)}function i(){return i=u(r().m((function e(t){return r().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=u(r().m((function e(n){return r().w((function(e){for(;;)switch(e.n){case 0:return console.log("Matching data: ",t),Office.context.ui.displayDialogAsync("https://localhost:3000/display.html",{height:65,width:55}),e.n=1,n.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),i.apply(this,arguments)}function s(){return(s=u(r().m((function e(){var t,n,o,a;return r().w((function(e){for(;;)switch(e.n){case 0:t=localStorage.getItem("matchingData"),console.log("Stored Value:",t),t&&(n=JSON.parse(t),o=document.getElementById("data-output"),a="<table>\n        <thead>\n            <tr>\n            <th>Item Code</th>\n            <th>Job Number</th>\n            <th>Quantity</th>\n            <th>Start Date</th>\n            </tr>\n        </thead>\n        <tbody>\n        ",n.forEach((function(e){var t,n,r,o,u=0===e.qty||""===e.date||null==e.date;a+="<tr".concat(u?' class="disabled"':"",">\n            <td>").concat(null!==(t=e.code)&&void 0!==t?t:"","</td>\n            <td>").concat(null!==(n=e.job)&&void 0!==n?n:"","</td>\n            <td>").concat(null!==(r=e.qty)&&void 0!==r?r:"","</td>\n            <td>").concat(null!==(o=e.fDate)&&void 0!==o?o:"","</td>\n            </tr>\n        ")})),a+="  </tbody>\n        </table>",o.innerHTML=a);case 1:return e.a(2)}}),e)})))).apply(this,arguments)}n.d(t,{P:function(){return c}}),Office.onReady((function(e){e.host===Office.HostType.Excel&&(window.onload=function(){return s.apply(this,arguments)}())}))},16286:function(e,t,n){e.exports=n.p+"assets/settings.jpeg"},21708:function(e,t,n){e.exports=n.p+"assets/SW.png"},58394:function(e,t,n){e.exports=n.p+"0d4eb8db7fb5335a19cb.css"},60947:function(e,t,n){e.exports=n.p+"002f889c7ecb529c7cc5.js"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){var e=n(10825),t=n(8086);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(r(e)+" is not iterable")}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){c=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw a}}}}function u(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return i(l,"_invoke",function(n,r,o){var a,c,i,s=0,l=o||[],f=!1,g={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,i=e,g.n=n,u}};function d(n,r){for(c=n,i=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=g.p,m=a[2];n>3?(o=m===r)&&(i=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,g.v=r,g.n=a[1]):d<m&&(o=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,g.n=m,c=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,m){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,m),c=l,i=m;(t=c<2?e:i)||!f;){a||(c?c<3?(c>1&&(g.n=-1),d(c,i)):g.n=i:g.v=i);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=g.n<0)?i:n.call(r,g))!==u)break}catch(t){a=e,c=1,i=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),l}var u={};function s(){}function l(){}function f(){}t=Object.getPrototypeOf;var g=[][r]?t(t([][r]())):(i(t={},r,(function(){return this})),t),d=f.prototype=s.prototype=Object.create(g);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,i(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=f,i(d,"constructor",f),i(f,"constructor",l),l.displayName="GeneratorFunction",i(f,o,"GeneratorFunction"),i(d),i(d,o,"Generator"),i(d,r,(function(){return this})),i(d,"toString",(function(){return"[object Generator]"})),(c=function(){return{w:a,m:m}})()}function i(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}i=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var a=function(t,n){i(e,t,(function(e){return this._invoke(t,n,e)}))};a("next",0),a("throw",1),a("return",2)}},i(e,t,n,r)}function s(e,t){if(e){if("string"==typeof e)return l(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t,n,r,o,a,u){try{var c=e[a](u),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function u(e){f(a,r,o,u,c,"next",e)}function c(e){f(a,r,o,u,c,"throw",e)}u(void 0)}))}}Office.onReady((function(e){e.host===Office.HostType.Excel&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("generate-ordering-report").onclick=function(){return S(I)},document.getElementById("generate-inventory-report").onclick=function(){return S(O)},document.getElementById("temp-reset").onclick=function(){return S(D)},document.getElementById("start-date").addEventListener("input",J),document.getElementById("end-date").addEventListener("input",J),document.getElementById("order-filtering").addEventListener("change",$),document.getElementById("settings-button").onclick=function(){return S(t.O)})}));var d,m,y=[],p=[],h=new Map,v=new Map,b=new Set,w=[],R=[];function I(){return E.apply(this,arguments)}function E(){return E=g(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=g(c().m((function e(t){var n,r;return c().w((function(e){for(;;)switch(e.n){case 0:return T(),e.n=1,t.sync();case 1:if(d=t.workbook.worksheets.add("Ordering"),(m=d.tables.add("A1:G1",!0)).name="OrderingTable",m.getHeaderRowRange().values=[["Case #","Demand","Current Inventory","On Order","Required Amount","Buy or Make","Earliest Start Date"]],m.columns.getItemAt(3).getRange().numberFormat=[["€#,##0.00"]],m.getRange().format.autofitColumns(),m.getRange().format.autofitRows(),n=document.getElementById("start-date").value,r=document.getElementById("end-date").value,n&&r){e.n=2;break}return document.getElementById("message-area").textContent="Please enter the dates",e.a(2);case 2:return document.getElementById("message-area").textContent=" ",W(),e.n=3,t.sync();case 3:C();case 4:return d.onSelectionChanged.add(Q),e.n=5,t.sync();case 5:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),E.apply(this,arguments)}function O(){return k.apply(this,arguments)}function k(){return k=g(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=g(c().m((function e(t){var n,r,o,a;return c().w((function(e){for(;;)switch(e.n){case 0:return F(),e.n=1,t.sync();case 1:if(n=t.workbook.worksheets.add("Inventory At"),(r=n.tables.add("A1:J1",!0)).name="InventoryAtTable",r.getHeaderRowRange().values=[["Case #","Demand","Qty MEB","Qty EFW","Total MEB + EFW","On Order","Start Date","Release Date","Qty Needed (MEB)","Notes"]],r.columns.getItemAt(2).getRange().numberFormat=[["€#,##0.00"]],r.getRange().format.autofitColumns(),r.getRange().format.autofitRows(),o=document.getElementById("start-date").value,a=document.getElementById("end-date").value,o&&a){e.n=2;break}return document.getElementById("message-area").textContent="Please enter the dates",e.a(2);case 2:return document.getElementById("message-area").textContent=" ",_(),e.n=3,t.sync();case 3:A();case 4:return e.n=5,t.sync();case 5:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),k.apply(this,arguments)}function S(e){return x.apply(this,arguments)}function x(){return(x=g(c().m((function e(t){var n;return c().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,t();case 1:e.n=3;break;case 2:e.p=2,n=e.v,alert(n),console.error(n);case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function C(){return B.apply(this,arguments)}function B(){return B=g(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=g(c().m((function e(t){var n,r,o,i,s,l,f,g,d,m,p,v,b,w,R,I,E,O,k,S,x,C,B,A,j,D,N,T,U,F,P,W,H,_,L,q,z,J,Q,V,$,K,X,Y,Z,ee,te,ne,re,oe,ae,ue,ce,ie,se,le,fe,ge,de,me,ye,pe,he,ve,be,we,Re,Ie,Ee,Oe,ke,Se,xe,Ce,Be,Ae,je,De,Ne,Te,Ue,Fe,Pe,Ge,Me,We,He,_e,Le,qe,ze,Je,Qe,Ve,$e,Ke,Xe,Ye,Ze,et,tt;return c().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getItem("Inventory"),r=n.getUsedRange().load("values"),o=t.workbook.worksheets.getItem("Dynamic"),i=o.getUsedRange().load("values"),s=t.workbook.worksheets.getItem("Open PO's"),l=s.getUsedRange().load("values"),f=t.workbook.worksheets.getItem("Ordering"),e.n=1,t.sync();case 1:return g=i.values[0],d=g.indexOf("Corrugate"),m=g.indexOf("Number of Corrugate"),p=g.indexOf("Work Center"),v="".concat(G(d),":").concat(G(d)),b="".concat(G(m),":").concat(G(m)),w="".concat(G(p),":").concat(G(p)),R=l.values[0],I=R.indexOf("Item Code"),E=R.indexOf("Outstanding Qty"),O="".concat(G(I),":").concat(G(I)),k="".concat(G(E),":").concat(G(E)),S=r.values[0],x=S.indexOf("Item Code"),C=S.indexOf("Inventory Qty"),B="".concat(G(x),":").concat(G(x)),A="".concat(G(C),":").concat(G(C)),j=t.workbook.worksheets.getItem("Dynamic"),D=j.getRange(b).getUsedRange().load("values"),N=j.getRange(v).getUsedRange().load("values"),T=j.getRange(w).getUsedRange().load("values"),e.n=2,t.sync();case 2:return U=n.getRange(B).getUsedRange().load("values"),F=n.getRange(A).getUsedRange().load("values"),P=t.workbook.worksheets.getItem("Open PO's"),W=P.getRange(O).getUsedRange().load("values"),H=P.getRange(k).getUsedRange().load("values"),e.n=3,t.sync();case 3:_=y.map((function(e){return[e.itemCode]})),L=y.map((function(e){return[e.qty]})),q=M(N.values,D.values),z=M(_,L),J=M(U.values,F.values),Q=M(W.values,H.values),V=new Set([].concat(u(z.keys()),u(J.keys()),u(Q.keys()))),$=[["Case #","Required Amount"]],K=a(V);try{for(K.s();!(X=K.n()).done;)Y=X.value,Z=z.get(Y)||0,ee=J.get(Y)||0,te=Q.get(Y)||0,(ne=Z-ee-te)>0&&$.push([Y,ne])}catch(e){K.e(e)}finally{K.f()}return re=$.map((function(e){return[e[0]]})),f.getRange("A1:A".concat(re.length)).values=re,oe=$.map((function(e){return[e[1]]})),f.getRange("E1:E".concat(oe.length)).values=oe,e.n=4,t.sync();case 4:ae=[["Case #","Remove From Order"]],ue=a(V);try{for(ue.s();!(ce=ue.n()).done;)ie=ce.value,se=Number(q.get(ie))||0,le=Number(Q.get(ie))||0,fe=le-se,isNaN(se)||isNaN(le)||String(ie).includes("COR")&&le>se&&ae.push([ie,fe])}catch(e){ue.e(e)}finally{ue.f()}return console.log("Sell these",ae),ge=f.getUsedRange().load("values"),e.n=5,t.sync();case 5:for(de=ge.values,me=[["Earliest Start Date"]],ye=1;ye<de.length;ye++)pe=String(de[ye][0]).trim(),he=String(h.get(pe))||"No Start Date Established",ve=he.split(" ").slice(0,4).join(" "),me.push([ve]);f.getRange("G1:G".concat(me.length)).values=me,be=$.map((function(e){return e[0]})),we=[["Demand"]],Re=a(be);try{for(Re.s();!(Ie=Re.n()).done;)Ee=Ie.value,(Oe=z.get(Ee)||0)>0&&we.push([Oe])}catch(e){Re.e(e)}finally{Re.f()}ke=we.map((function(e){return[e[0]]})),f.getRange("B1:B".concat(ke.length)).values=ke,Se=[["Current Inventory"]],xe=a(be.slice(1));try{for(xe.s();!(Ce=xe.n()).done;)Be=Ce.value,Ae=J.get(Be)||0,Se.push([Ae])}catch(e){xe.e(e)}finally{xe.f()}je=Se.map((function(e){return[e[0]]})),f.getRange("C1:C".concat(je.length)).values=je,De=[["On Order"]],Ne=a(be.slice(1));try{for(Ne.s();!(Te=Ne.n()).done;)Ue=Te.value,Fe=Q.get(Ue)||0,De.push([Fe])}catch(e){Ne.e(e)}finally{Ne.f()}for(Pe=De.map((function(e){return[e[0]]})),f.getRange("D1:D".concat(Pe.length)).values=Pe,Ge=new Map,Me=1;Me<N.values.length;Me++)We=String(N.values[Me][0]).trim(),He=T.values[Me]?String(T.values[Me][0]).trim():"",We&&He&&(Ge.has(We)||Ge.set(We,new Set),Ge.get(We).add(He));return e.n=6,t.sync();case 6:_e=[["Buy or Make"]],Le=a(be.slice(1));try{for(Le.s();!(qe=Le.n()).done;)ze=qe.value,Je=Ge.get(ze),Qe=Je?Array.from(Je).join(", "):"",_e.push([Qe])}catch(e){Le.e(e)}finally{Le.f()}Ve=_e.map((function(e){return[e[0]]})),$e=[["Buy or Make"]],Ke=1;case 7:if(!(Ke<Ve.length)){e.n=9;break}return(Xe=Ve[Ke][0]).includes("40FGAL3A")||Xe.includes("40FGAL3B")||Xe.includes("40FGAL3C")||Xe.includes("40FGSI2A")||Xe.includes("40AIFG2B")?$e.push(["Must Buy"]):Number(oe[Ke][0])>=300?$e.push(["Can Buy"]):$e.push(["Can Make"]),e.n=8,t.sync();case 8:Ke++,e.n=7;break;case 9:return f.getRange("F1:F".concat($e.length)).values=$e,f.getRange("A:G").format.autofitColumns(),f.getRange("A:H").format.horizontalAlignment="Center",f.getRange("A:H").format.verticalAlignment="Center",f.getRange("D:D").numberFormat=[["General"]],f.getRange("A:A").format.columnWidth=150,f.getRange("B:B").format.columnWidth=90,f.getRange("C:C").format.columnWidth=120,f.getRange("D:D").format.columnWidth=90,f.getRange("E:E").format.columnWidth=130,f.getRange("F:F").format.columnWidth=100,f.getRange("B:B").format.columnWidth=130,f.getUsedRange().format.rowHeight=30,f.freezePanes.freezeRows(1),f.getRange("E1:E1").format.fill.color="#BE5014",f.getRange("E1:E1").format.font.color="yellow",Ye=f.getUsedRange(),Ze=Ye.format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight","InsideVertical","InsideHorizontal"].forEach((function(e){Ze.getItem(e).style="Continuous",Ze.getItem(e).weight="Thin",Ze.getItem(e).color="#000000"})),et=ke.length,tt=f.getRange("E1:E".concat(et)).format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight"].forEach((function(e){tt.getItem(e).style="Continuous",tt.getItem(e).weight="Thick",tt.getItem(e).color="#BE5014"})),e.n=10,t.sync();case 10:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),B.apply(this,arguments)}function A(e){return j.apply(this,arguments)}function j(){return j=g(c().m((function e(t){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=g(c().m((function e(t){var n,r,o,u,i,s,l,f,g,d,m,y,h,b,w,R,I,E,O,k,S,x,C,B,A,j,D,N,T,U,F,P,W,H,_,L,q,z,J,Q,V,$,K,X,Y,Z,ee,te,ne,re,oe,ae,ue,ce,ie,se,le,fe,ge,de,me,ye,pe,he,ve,be,we,Re,Ie,Ee,Oe,ke,Se,xe,Ce;return c().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getItem("Inventory"),r=n.getUsedRange().load("values"),o=t.workbook.worksheets.getItem("Dynamic"),u=o.getUsedRange().load("values"),i=t.workbook.worksheets.getItem("Open PO's"),s=i.getUsedRange().load("values"),l=t.workbook.worksheets.getItem("Inventory At"),e.n=1,t.sync();case 1:return f=u.values[0],g=f.indexOf("Corrugate"),d=f.indexOf("Number of Corrugate"),"".concat(G(g),":").concat(G(g)),"".concat(G(d),":").concat(G(d)),m=s.values[0],y=m.indexOf("Item Code"),h=m.indexOf("Outstanding Qty"),b="".concat(G(y),":").concat(G(y)),w="".concat(G(h),":").concat(G(h)),R=r.values[0],I=R.indexOf("Item Code"),E=R.indexOf("Inventory Qty"),O=R.indexOf("Location"),k="".concat(G(I),":").concat(G(I)),S="".concat(G(E),":").concat(G(E)),x="".concat(G(O),":").concat(G(O)),e.n=2,t.sync();case 2:return C=n.getRange(k).getUsedRange().load("values"),B=n.getRange(S).getUsedRange().load("values"),A=n.getRange(x).getUsedRange().load("values"),j=t.workbook.worksheets.getItem("Open PO's"),D=j.getRange(b).getUsedRange().load("values"),N=j.getRange(w).getUsedRange().load("values"),e.n=3,t.sync();case 3:T=p.map((function(e){return[e.itemCode]})),U=p.map((function(e){return[e.qty]})),F=M(T,U),P=[["Case #","Demand"]],W=a(F.keys());try{for(W.s();!(H=W.n()).done;)_=H.value,(L=F.get(_)||0)>0&&P.push([_,L])}catch(e){W.e(e)}finally{W.f()}return e.n=4,t.sync();case 4:for(q=P.map((function(e){return e[0]})),l.getRange("A1:A".concat(q.length)).values=q.map((function(e){return[e]})),z=P.map((function(e){return[e[1]]})),console.log("Required Amounts",z),l.getRange("B1:B".concat(z.length)).values=z,J=[],Q=[],V=0;V<q.length;V++){for($=String(q[V]).trim(),K=!1,X=0;X<C.values.length;X++)Y=String(C.values[X][0]).trim(),Z=String(A.values[X][0]).trim(),ee=Number(B.values[X][0]),$===Y&&(te=Z.includes("MEB"),ne=Z.includes("EFW"),J.push([$,te?ee:0]),Q.push([$,ne?ee:0]),K=!0);K||(J.push([$,0]),Q.push([$,0]))}return e.n=5,t.sync();case 5:re=M(J.map((function(e){return[e[0]]})),J.map((function(e){return[e[1]]}))),oe=Array.from(re.entries()).map((function(e){return[e[1]]})),l.getRange("C2:C".concat(oe.length+1)).values=oe,ae=M(Q.map((function(e){return[e[0]]})),Q.map((function(e){return[e[1]]}))),ue=Array.from(ae.entries()).map((function(e){return[e[1]]})),l.getRange("D2:D".concat(ue.length+1)).values=ue,ce=oe.map((function(e,t){return Number(e)+ue[t][0]})),l.getRange("E2:E".concat(ce.length+1)).values=ce.map((function(e){return[e]})),ie=M(D.values,N.values),se=[["On Order"]],le=a(q.slice(1));try{for(le.s();!(fe=le.n()).done;)ge=fe.value,de=ie.get(ge)||0,se.push([de])}catch(e){le.e(e)}finally{le.f()}for(me=se.map((function(e){return[e[0]]})),l.getRange("F1:F".concat(me.length)).values=me,ye=[["Earliest Start Date"]],pe=[["Release Date"]],he=1;he<q.length;he++)ve=String(q[he]).trim(),be=String(v.get(ve))||"No Start Date Established",we=be.split(" ").slice(0,4).join(" "),ye.push([we]),Re=new Date(be),isNaN(Re)?pe.push(["Invalid Release Date"]):(Re.setDate(Re.getDate()-10),Ie=Re.toDateString(),pe.push([Ie]));return l.getRange("G1:G".concat(ye.length)).values=ye,l.getRange("H1:H".concat(pe.length)).values=pe,Ee=z.slice(1).map((function(e,t){return Number(e)-oe[t]})),l.getRange("I2:I".concat(Ee.length+1)).values=Ee.map((function(e){return[e]})),e.n=6,t.sync();case 6:for(Oe=Ee.length-1;Oe>=0;Oe--)Ee[Oe]<=0?l.getRange("I".concat(Oe+2)).getEntireRow().delete(ExcelScript.DeleteShiftDirection.up):l.getRange("I".concat(Oe+2)).setValue(Ee[Oe]);return l.getRange("A:J").format.autofitColumns(),l.getRange("A:J").format.horizontalAlignment="Center",l.getRange("A:J").format.verticalAlignment="Center",l.getRange("C:C").numberFormat=[["General"]],l.getRange("A:A").format.columnWidth=120,l.getRange("B:B").format.columnWidth=70,l.getRange("C:C").format.columnWidth=70,l.getRange("D:D").format.columnWidth=70,l.getRange("E:E").format.columnWidth=100,l.getRange("F:F").format.columnWidth=75,l.getRange("G:G").format.columnWidth=90,l.getRange("H:H").format.columnWidth=90,l.getRange("I:I").format.columnWidth=130,l.getRange("J:J").format.columnWidth=150,l.getUsedRange().format.rowHeight=20,l.freezePanes.freezeRows(1),l.getRange("I1:I1").format.fill.color="#BE5014",l.getRange("I1:I1").format.font.color="yellow",ke=l.getUsedRange(),Se=ke.format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight","InsideVertical","InsideHorizontal"].forEach((function(e){Se.getItem(e).style="Continuous",Se.getItem(e).weight="Thin",Se.getItem(e).color="#000000"})),xe=oe.length,Ce=l.getRange("I1:I".concat(xe+1)).format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight"].forEach((function(e){Ce.getItem(e).style="Continuous",Ce.getItem(e).weight="Thick",Ce.getItem(e).color="#BE5014"})),e.n=7,t.sync();case 7:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),j.apply(this,arguments)}function D(){return N.apply(this,arguments)}function N(){return N=g(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=g(c().m((function e(t){var n;return c().w((function(e){for(;;)switch(e.n){case 0:return(n=t.workbook.worksheets).getItemOrNullObject("Ordering").delete(),n.getItemOrNullObject("Inventory At").delete(),n.getItemOrNullObject("Test").delete(),document.getElementById("start-date").value="",document.getElementById("end-date").value="",e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),N.apply(this,arguments)}function T(){return U.apply(this,arguments)}function U(){return U=g(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=g(c().m((function e(t){return c().w((function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.getItemOrNullObject("Ordering").delete(),y=[],h.clear(),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),U.apply(this,arguments)}function F(){return P.apply(this,arguments)}function P(){return P=g(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=g(c().m((function e(t){return c().w((function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.getItemOrNullObject("Inventory At").delete(),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),P.apply(this,arguments)}function G(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}function M(e,t){for(var n=new Map,r=1;r<e.length;r++){var o=e[r][0],a=Number(t[r][0]);o&&!isNaN(a)&&n.set(o,(n.get(o)||0)+a)}return n}function W(){return H.apply(this,arguments)}function H(){return H=g(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=g(c().m((function e(t){var n,r,o,u,i,s,l,f,g,d,m,p,v,b,R,I,E,O,k,S,x,C,B,A,j,D,N,T,U,F,P,M,W,H,_,L,J,Q;return c().w((function(e){for(;;)switch(e.n){case 0:return n=document.getElementById("start-date").value,r=document.getElementById("end-date").value,o=q(n),u=q(r),i=t.workbook.worksheets.getItem("Dynamic"),s=i.getUsedRange().load("values"),e.n=1,t.sync();case 1:return l=s.values[0],f=l.indexOf("Corrugate"),g=l.indexOf("Planned Start"),d=l.indexOf("Number of Corrugate"),m=l.indexOf("Order Number"),p="".concat(G(g),":").concat(G(g)),v="".concat(G(d),":").concat(G(d)),b="".concat(G(f),":").concat(G(f)),R="".concat(G(m),":").concat(G(m)),I=t.workbook.worksheets.getItem("Dynamic"),E=I.getRange(b).getUsedRange().load("values"),O=I.getRange(v).getUsedRange().load("values"),k=i.getRange(p).getUsedRange().load("values"),S=i.getRange(R).getUsedRange().load("values"),e.n=2,t.sync();case 2:for(x=new Map,C=1;C<E.values.length;C++)B=String(E.values[C][0]).trim(),A=k.values[C]?String(k.values[C][0]).trim():"",(j=z(A)).setHours(0,0,0,0),D=String(S.values[C][0]).trim(),N=Number(O.values[C][0]),B&&j>=o&&j<=u&&(!x.has(D)||j>x.get(D).date)&&x.set(D,{itemCode:B,qty:N,date:j,job:D});y=Array.from(x.values()),h.clear(),T=a(y);try{for(T.s();!(U=T.n()).done;)F=U.value,P=F.itemCode,M=F.date,(!h.has(P)||M<h.get(P))&&h.set(P,M)}catch(e){T.e(e)}finally{T.f()}return y.sort((function(e,t){return e.date-t.date})),e.n=3,t.sync();case 3:for(W=1;W<E.values.length;W++)H=String(E.values[W][0]).trim(),_=k.values[W]?String(k.values[W][0]).trim():"",(L=z(_)).setHours(0,0,0,0),J=String(S.values[W][0]).trim(),Q=Number(O.values[W][0]),H&&w.push({itemCode:H,qty:Q,job:J,date:L});case 4:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),H.apply(this,arguments)}function _(){return L.apply(this,arguments)}function L(){return L=g(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=g(c().m((function e(t){var n,r,o,u,i,s,l,f,g,d,m,y,h,b,w,R,I,E,O,k,S,x,C,B,A,j,D,N,T,U,F,P;return c().w((function(e){for(;;)switch(e.n){case 0:return n=document.getElementById("start-date").value,r=document.getElementById("end-date").value,o=q(n),u=q(r),i=t.workbook.worksheets.getItem("Dynamic"),s=i.getUsedRange().load("values"),e.n=1,t.sync();case 1:return l=s.values[0],f=l.indexOf("Corrugate"),g=l.indexOf("Planned Start"),d=l.indexOf("Number of Corrugate"),m=l.indexOf("Order Number"),y="".concat(G(g),":").concat(G(g)),h="".concat(G(d),":").concat(G(d)),b="".concat(G(f),":").concat(G(f)),w="".concat(G(m),":").concat(G(m)),R=t.workbook.worksheets.getItem("Dynamic"),I=R.getRange(b).getUsedRange().load("values"),E=R.getRange(h).getUsedRange().load("values"),O=i.getRange(y).getUsedRange().load("values"),k=i.getRange(w).getUsedRange().load("values"),e.n=2,t.sync();case 2:for(S=new Map,x=1;x<I.values.length;x++)C=String(I.values[x][0]).trim(),B=O.values[x]?String(O.values[x][0]).trim():"",(A=z(B)).setHours(0,0,0,0),j=String(k.values[x][0]).trim(),D=Number(E.values[x][0]),C&&A>=o&&A<=u&&(!S.has(j)||A>S.get(j).date)&&S.set(j,{itemCode:C,qty:D,date:A,job:j});p=Array.from(S.values()),v.clear(),N=a(p);try{for(N.s();!(T=N.n()).done;)U=T.value,F=U.itemCode,P=U.date,(!v.has(F)||P<v.get(F))&&v.set(F,P)}catch(e){N.e(e)}finally{N.f()}return p.sort((function(e,t){return e.date-t.date})),e.n=3,t.sync();case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),L.apply(this,arguments)}function q(e){var t,n,r=(t=e.split("-").map(Number),n=3,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,u,c=[],i=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{if(!i&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(s)throw o}}return c}}(t,n)||s(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],a=r[1],u=r[2];return new Date(o,a-1,u)}function z(e){var t=new Date(86400*(e-25569)*1e3);return new Date(t.getTime()+6e4*t.getTimezoneOffset())}function J(){var e=document.getElementById("start-date").value,t=document.getElementById("end-date").value;e&&t&&(document.getElementById("message-area").textContent="")}function Q(e){return V.apply(this,arguments)}function V(){return V=g(c().m((function t(n){return c().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,Excel.run(function(){var t=g(c().m((function t(r){var a,u,i,s,l,f,g,d,m;return c().w((function(t){for(;;)switch(t.n){case 0:return a=r.workbook.worksheets.getItem("Ordering"),(u=a.getRange(n.address)).load(["columnIndex","values","address"]),t.n=1,r.sync();case 1:if(console.log("Index Number",u.columnIndex),b.clear(),0!=u.columnIndex){t.n=5;break}R.length=0,i=u.values[0],s=w.map((function(e){return[e.itemCode]})),l=w.map((function(e){return[e.job]})),f=w.map((function(e){return[e.qty]})),g=w.map((function(e){return[e.date]})),d=c().m((function e(){var t,n,r,o,a,u,d;return c().w((function(e){for(;;)switch(e.n){case 0:t=s[m][0],n=l[m][0],r=f[m][0],o=g[m][0],a=new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-"),i==t&&(b.has(n)?(u=h.get(t),-1!==(d=R.findIndex((function(e){return e.job===n&&e.code===t})))&&(R[d].date=u)):(R.push({code:t,job:n,qty:r,fDate:a}),b.add(n)));case 1:return e.a(2)}}),e)})),m=0;case 2:if(!(m<s.length)){t.n=4;break}return t.d(o(d()),3);case 3:m++,t.n=2;break;case 4:console.log("intial finding of Matching Data",R),(0,e.P)([].concat(R)),R.sort((function(e,t){return e.date-t.date})),localStorage.setItem("matchingData",JSON.stringify(R)),t.n=6;break;case 5:console.log("Not in range");case 6:return t.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:return t.a(2)}}),t)}))),V.apply(this,arguments)}function $(){return K.apply(this,arguments)}function K(){return K=g(c().m((function e(){return c().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=g(c().m((function e(t){var n,r,o,a,u;return c().w((function(e){for(;;)switch(e.n){case 0:n=t.workbook.worksheets.getItem("Ordering"),r=n.tables.getItem("OrderingTable"),o=r.columns.getItem("Required Amount").filter,a=r.columns.getItem("Buy or Make").filter,u=document.getElementById("order-filtering").value,e.n="Intial"===u?1:"over-300"===u?2:"Must-buy"===u?3:"Can-buy"===u?4:"Can-make"===u?5:6;break;case 1:return console.log("no changes made"),o.clear(),a.clear(),e.a(3,7);case 2:return o.clear(),a.clear(),o.applyCustomFilter(">=300"),e.a(3,7);case 3:return o.clear(),a.clear(),a.applyValuesFilter(["Must Buy"]),e.a(3,7);case 4:return o.clear(),a.clear(),a.applyValuesFilter(["Can Buy"]),e.a(3,7);case 5:return o.clear(),a.clear(),a.applyValuesFilter(["Can Make"]),e.a(3,7);case 6:return console.log("No valid filter selected"),e.a(3,7);case 7:return e.n=8,t.sync();case 8:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),K.apply(this,arguments)}}(),new URL(n(58394),n.b),new URL(n(16286),n.b),new URL(n(21708),n.b),new URL(n(60947),n.b)}();
//# sourceMappingURL=taskpane.js.map