/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={21708:function(e,t,n){"use strict";e.exports=n.p+"assets/SW.png"},58394:function(e,t,n){"use strict";e.exports=n.p+"21ed519e9c28bda1a220.css"},60947:function(e,t,n){"use strict";e.exports=n.p+"7d71f9628a6d34f87b05.js"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,c=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,u=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw u}}}}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(){var e,t,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",u=a.toStringTag||"@@toStringTag";function c(n,a,o,u){var c=a&&a.prototype instanceof s?a:s,l=Object.create(c.prototype);return r(l,"_invoke",function(n,r,a){var o,u,c,s=0,l=a||[],f=!1,g={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return o=t,u=0,c=e,g.n=n,i}};function d(n,r){for(u=n,c=r,t=0;!f&&s&&!a&&t<l.length;t++){var a,o=l[t],d=g.p,m=o[2];n>3?(a=m===r)&&(c=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=e):o[0]<=d&&((a=n<2&&d<o[1])?(u=0,g.v=r,g.n=o[1]):d<m&&(a=n<3||o[0]>r||r>m)&&(o[4]=n,o[5]=r,g.n=m,u=0))}if(a||n>1)return i;throw f=!0,r}return function(a,l,m){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,m),u=l,c=m;(t=u<2?e:c)||!f;){o||(u?u<3?(u>1&&(g.n=-1),d(u,c)):g.n=c:g.v=c);try{if(s=2,o){if(u||(a="next"),t=o[a]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,u<2&&(u=0)}else 1===u&&(t=o.return)&&t.call(o),u<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),u=1);o=e}else if((t=(f=g.n<0)?c:n.call(r,g))!==i)break}catch(t){o=e,u=1,c=t}finally{s=1}}return{value:t,done:f}}}(n,o,u),!0),l}var i={};function s(){}function l(){}function f(){}t=Object.getPrototypeOf;var g=[][o]?t(t([][o]())):(r(t={},o,(function(){return this})),t),d=f.prototype=s.prototype=Object.create(g);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,u,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=f,r(d,"constructor",f),r(f,"constructor",l),l.displayName="GeneratorFunction",r(f,u,"GeneratorFunction"),r(d),r(d,u,"Generator"),r(d,o,(function(){return this})),r(d,"toString",(function(){return"[object Generator]"})),(n=function(){return{w:c,m:m}})()}function r(e,t,n,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}r=function(e,t,n,a){if(t)o?o(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n;else{var u=function(t,n){r(e,t,(function(e){return this._invoke(t,n,e)}))};u("next",0),u("throw",1),u("return",2)}},r(e,t,n,a)}function a(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n,r,a,o,u){try{var c=e[o](u),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){u(o,r,a,c,i,"next",e)}function i(e){u(o,r,a,c,i,"throw",e)}c(void 0)}))}}Office.onReady((function(e){e.host===Office.HostType.Excel&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("generate-ordering-report").onclick=function(){return b(p)},document.getElementById("generate-inventory-report").onclick=function(){return b(v)},document.getElementById("temp-reset").onclick=function(){return b(k)},document.getElementById("start-date").addEventListener("input",T),document.getElementById("end-date").addEventListener("input",T))}));var i,s,l=[],f=new Map,g=new Set,d=[];function m(){return y.apply(this,arguments)}function y(){return y=c(n().m((function e(){return n().w((function(e){for(;;)switch(e.n){case 0:return console.log("displayData event fired"),e.n=1,Excel.run(function(){var e=c(n().m((function e(t){var r,a;return n().w((function(e){for(;;)switch(e.n){case 0:return r=t.workbook.worksheets.getItem("Ordering"),(a=r.getSelectedRange()).load(["columnIndex","values","address"]),e.n=1,t.sync();case 1:0===a.columnIndex&&console.log("Selected cell(s) in column A:",a.values);case 2:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),y.apply(this,arguments)}function p(){return h.apply(this,arguments)}function h(){return h=c(n().m((function e(){return n().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=c(n().m((function e(t){var r,a;return n().w((function(e){for(;;)switch(e.n){case 0:return S(),e.n=1,t.sync();case 1:if(i=t.workbook.worksheets.add("Ordering"),(s=i.tables.add("A1:G1",!0)).name="OrderingTable",s.getHeaderRowRange().values=[["Case #","Demand","Current Inventory","On Order","Required Amount","Buy or Make","Earliest Start Date"]],s.columns.getItemAt(3).getRange().numberFormat=[["€#,##0.00"]],s.getRange().format.autofitColumns(),s.getRange().format.autofitRows(),r=document.getElementById("start-date").value,a=document.getElementById("end-date").value,i.onSelectionChanged.add(m),r&&a){e.n=2;break}return document.getElementById("message-area").textContent="Please enter the dates",e.a(2);case 2:return document.getElementById("message-area").textContent=" ",B(),e.n=3,t.sync();case 3:E();case 4:return e.n=5,t.sync();case 5:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),h.apply(this,arguments)}function v(){return w.apply(this,arguments)}function w(){return w=c(n().m((function e(){return n().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=c(n().m((function e(t){var r,a;return n().w((function(e){for(;;)switch(e.n){case 0:return r=t.workbook.worksheets.add("Inventory At"),(a=r.tables.add("A1:F1",!0)).name="InventoryAtTable",a.getHeaderRowRange().values=[["Material","Demand","MEB","EFW","Release","Planned Start Date"]],a.columns.getItemAt(2).getRange().numberFormat=[["€#,##0.00"]],a.getRange().format.autofitColumns(),a.getRange().format.autofitRows(),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),w.apply(this,arguments)}function b(e){return R.apply(this,arguments)}function R(){return(R=c(n().m((function e(t){var r;return n().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,t();case 1:e.n=3;break;case 2:e.p=2,r=e.v,alert(r),console.error(r);case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function E(){return I.apply(this,arguments)}function I(){return I=c(n().m((function r(){return n().w((function(r){for(;;)switch(r.n){case 0:return r.n=1,Excel.run(function(){var r=c(n().m((function r(a){var o,u,c,i,s,g,d,m,y,p,h,v,w,b,R,E,I,k,O,S,C,B,j,N,U,T,D,F,G,P,M,L,W,H,_,q,z,$,Q,V,J,K,X,Y,Z,ee,te,ne,re,ae,oe,ue,ce,ie,se,le,fe,ge,de,me,ye,pe,he,ve,we,be,Re,Ee,Ie,ke,Oe,Se,Ce,Ae,xe,Be,je,Ne,Ue,Te,De,Fe,Ge,Pe,Me,Le,We,He,_e,qe,ze,$e,Qe,Ve,Je,Ke,Xe,Ye,Ze,et,tt;return n().w((function(n){for(;;)switch(n.n){case 0:return o=a.workbook.worksheets.getItem("Inventory"),u=o.getUsedRange().load("values"),c=a.workbook.worksheets.getItem("Dynamic"),i=c.getUsedRange().load("values"),s=a.workbook.worksheets.getItem("Open PO's"),g=s.getUsedRange().load("values"),d=a.workbook.worksheets.getItem("Ordering"),n.n=1,a.sync();case 1:return m=i.values[0],y=m.indexOf("Corrugate"),p=m.indexOf("Number of Corrugate"),h=m.indexOf("Work Center"),v="".concat(A(y),":").concat(A(y)),w="".concat(A(p),":").concat(A(p)),b="".concat(A(h),":").concat(A(h)),R=g.values[0],E=R.indexOf("Item Code"),I=R.indexOf("Outstanding Qty"),k="".concat(A(E),":").concat(A(E)),O="".concat(A(I),":").concat(A(I)),S=u.values[0],C=S.indexOf("Item Code"),B=S.indexOf("Inventory Qty"),j="".concat(A(C),":").concat(A(C)),N="".concat(A(B),":").concat(A(B)),U=a.workbook.worksheets.getItem("Dynamic"),T=U.getRange(w).getUsedRange().load("values"),D=U.getRange(v).getUsedRange().load("values"),F=U.getRange(b).getUsedRange().load("values"),n.n=2,a.sync();case 2:return G=o.getRange(j).getUsedRange().load("values"),P=o.getRange(N).getUsedRange().load("values"),M=a.workbook.worksheets.getItem("Open PO's"),L=M.getRange(k).getUsedRange().load("values"),W=M.getRange(O).getUsedRange().load("values"),n.n=3,a.sync();case 3:H=l.map((function(e){return[e.itemCode]})),_=l.map((function(e){return[e.qty]})),q=x(D.values,T.values),z=x(H,_),$=x(G.values,P.values),Q=x(L.values,W.values),V=new Set([].concat(t(z.keys()),t($.keys()),t(Q.keys()))),J=[["Case #","Required Amount"]],K=e(V);try{for(K.s();!(X=K.n()).done;)Y=X.value,Z=z.get(Y)||0,ee=$.get(Y)||0,te=Q.get(Y)||0,(ne=Z-ee-te)>0&&J.push([Y,ne])}catch(e){K.e(e)}finally{K.f()}return re=J.map((function(e){return[e[0]]})),d.getRange("A1:A".concat(re.length)).values=re,ae=J.map((function(e){return[e[1]]})),d.getRange("E1:E".concat(ae.length)).values=ae,n.n=4,a.sync();case 4:oe=[["Case #","Remove From Order"]],ue=e(V);try{for(ue.s();!(ce=ue.n()).done;)ie=ce.value,se=Number(q.get(ie))||0,le=Number(Q.get(ie))||0,fe=le-se,isNaN(se)||isNaN(le)||String(ie).includes("COR")&&le>se&&oe.push([ie,fe])}catch(e){ue.e(e)}finally{ue.f()}return ge=d.getUsedRange().load("values"),n.n=5,a.sync();case 5:for(de=ge.values,me=[["Earliest Start Date"]],ye=1;ye<de.length;ye++)pe=String(de[ye][0]).trim(),he=String(f.get(pe))||"No Start Date Established",ve=he.split(" ").slice(0,4).join(" "),me.push([ve]);d.getRange("G1:G".concat(me.length)).values=me,we=J.map((function(e){return e[0]})),be=[["Demand"]],Re=e(we);try{for(Re.s();!(Ee=Re.n()).done;)Ie=Ee.value,(ke=z.get(Ie)||0)>0&&be.push([ke])}catch(e){Re.e(e)}finally{Re.f()}Oe=be.map((function(e){return[e[0]]})),d.getRange("B1:B".concat(Oe.length)).values=Oe,Se=[["Current Inventory"]],Ce=e(we.slice(1));try{for(Ce.s();!(Ae=Ce.n()).done;)xe=Ae.value,Be=$.get(xe)||0,Se.push([Be])}catch(e){Ce.e(e)}finally{Ce.f()}je=Se.map((function(e){return[e[0]]})),d.getRange("C1:C".concat(je.length)).values=je,Ne=[["On Order"]],Ue=e(we.slice(1));try{for(Ue.s();!(Te=Ue.n()).done;)De=Te.value,Fe=Q.get(De)||0,Ne.push([Fe])}catch(e){Ue.e(e)}finally{Ue.f()}for(Ge=Ne.map((function(e){return[e[0]]})),d.getRange("D1:D".concat(Ge.length)).values=Ge,Pe=new Map,Me=1;Me<D.values.length;Me++)Le=String(D.values[Me][0]).trim(),We=F.values[Me]?String(F.values[Me][0]).trim():"",Le&&We&&(Pe.has(Le)||Pe.set(Le,new Set),Pe.get(Le).add(We));return n.n=6,a.sync();case 6:He=[["Buy or Make"]],_e=e(we.slice(1));try{for(_e.s();!(qe=_e.n()).done;)ze=qe.value,$e=Pe.get(ze),Qe=$e?Array.from($e).join(", "):"",He.push([Qe])}catch(e){_e.e(e)}finally{_e.f()}Ve=He.map((function(e){return[e[0]]})),Je=[["Buy or Make"]],Ke=1;case 7:if(!(Ke<Ve.length)){n.n=9;break}return(Xe=Ve[Ke][0]).includes("40FGAL3A")||Xe.includes("40FGAL3B")||Xe.includes("40FGAL3C")||Xe.includes("40FGSI2A")||Xe.includes("40AIFG2B")?Je.push(["Must Buy"]):Number(ae[Ke][0])>=300?Je.push(["Can Buy"]):Je.push(["Can Make"]),n.n=8,a.sync();case 8:Ke++,n.n=7;break;case 9:return d.getRange("F1:F".concat(Je.length)).values=Je,d.getRange("A:G").format.autofitColumns(),d.getRange("A:H").format.horizontalAlignment="Center",d.getRange("A:H").format.verticalAlignment="Center",d.getRange("D:D").numberFormat=[["General"]],d.getRange("A:A").format.columnWidth=150,d.getRange("B:B").format.columnWidth=90,d.getRange("C:C").format.columnWidth=120,d.getRange("D:D").format.columnWidth=90,d.getRange("E:E").format.columnWidth=130,d.getRange("F:F").format.columnWidth=100,d.getRange("B:B").format.columnWidth=130,d.getUsedRange().format.rowHeight=30,d.freezePanes.freezeRows(1),d.getRange("E1:E1").format.fill.color="#BE5014",d.getRange("E1:E1").format.font.color="yellow",Ye=d.getUsedRange(),Ze=Ye.format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight","InsideVertical","InsideHorizontal"].forEach((function(e){Ze.getItem(e).style="Continuous",Ze.getItem(e).weight="Thin",Ze.getItem(e).color="#000000"})),et=Oe.length,tt=d.getRange("E1:E".concat(et)).format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight"].forEach((function(e){tt.getItem(e).style="Continuous",tt.getItem(e).weight="Thick",tt.getItem(e).color="#BE5014"})),n.n=10,a.sync();case 10:return n.a(2)}}),r)})));return function(e){return r.apply(this,arguments)}}());case 1:return r.a(2)}}),r)}))),I.apply(this,arguments)}function k(){return O.apply(this,arguments)}function O(){return O=c(n().m((function e(){return n().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=c(n().m((function e(t){var r;return n().w((function(e){for(;;)switch(e.n){case 0:return(r=t.workbook.worksheets).getItemOrNullObject("Ordering").delete(),r.getItemOrNullObject("Inventory At").delete(),r.getItemOrNullObject("Test").delete(),document.getElementById("start-date").value="",document.getElementById("end-date").value="",e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),O.apply(this,arguments)}function S(){return C.apply(this,arguments)}function C(){return C=c(n().m((function e(){return n().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=c(n().m((function e(t){return n().w((function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.getItemOrNullObject("Ordering").delete(),l=[],g.clear(),f.clear(),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),C.apply(this,arguments)}function A(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}function x(e,t){for(var n=new Map,r=1;r<e.length;r++){var a=e[r][0],o=Number(t[r][0]);a&&!isNaN(o)&&n.set(a,(n.get(a)||0)+o)}return n}function B(){return j.apply(this,arguments)}function j(){return j=c(n().m((function e(){return n().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=c(n().m((function e(t){var r,a,o,u,c,i,s,m,y,p,h,v,w,b,R,E,I,k,O,S,C,x,B,j,T,D,F,G,P,M,L,W;return n().w((function(e){for(;;)switch(e.n){case 0:return r=document.getElementById("start-date").value,a=document.getElementById("end-date").value,o=N(r),u=N(a),c=t.workbook.worksheets.getItem("Dynamic"),i=c.getUsedRange().load("values"),e.n=1,t.sync();case 1:return s=i.values[0],m=s.indexOf("Corrugate"),y=s.indexOf("Planned Start"),p=s.indexOf("Number of Corrugate"),h=s.indexOf("Order Number"),v="".concat(A(y),":").concat(A(y)),w="".concat(A(p),":").concat(A(p)),b="".concat(A(m),":").concat(A(m)),R="".concat(A(h),":").concat(A(h)),E=t.workbook.worksheets.getItem("Dynamic"),I=E.getRange(b).getUsedRange().load("values"),k=E.getRange(w).getUsedRange().load("values"),O=c.getRange(v).getUsedRange().load("values"),S=c.getRange(R).getUsedRange().load("values"),e.n=2,t.sync();case 2:for(C=1;C<I.values.length;C++)x=String(I.values[C][0]).trim(),B=O.values[C]?String(O.values[C][0]).trim():"",j=U(B),T=String(S.values[C][0]).trim(),j.setHours(0,0,0,0),D=Number(k.values[C][0]),x&&j>=o&&j<=u&&!g.has(T)&&(l.push({itemCode:x,qty:D,date:j}),g.add(T),f.has(x)&&j<=f.get(x)?f.set(x,j):f.has(x)||f.set(x,j));return l.sort((function(e,t){return e.date-t.date})),e.n=3,t.sync();case 3:for(F=1;F<I.values.length;F++)G=String(I.values[F][0]).trim(),P=O.values[F]?String(O.values[F][0]).trim():"",(M=U(P)).setHours(0,0,0,0),L=String(S.values[F][0]).trim(),W=Number(k.values[F][0]),G&&d.push({itemCode:G,qty:W,job:L,date:M});case 4:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),j.apply(this,arguments)}function N(e){var t,n,r=(t=e.split("-").map(Number),n=3,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,u,c=[],i=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{if(!i&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(s)throw a}}return c}}(t,n)||a(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],u=r[1],c=r[2];return new Date(o,u-1,c)}function U(e){var t=new Date(86400*(e-25569)*1e3);return new Date(t.getTime()+6e4*t.getTimezoneOffset())}function T(){var e=document.getElementById("start-date").value,t=document.getElementById("end-date").value;e&&t&&(document.getElementById("message-area").textContent="")}}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(21708),n.b),new URL(n(60947),n.b)}()}();
//# sourceMappingURL=taskpane.js.map