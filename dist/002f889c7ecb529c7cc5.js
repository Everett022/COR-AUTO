/*! For license information please see 002f889c7ecb529c7cc5.js.LICENSE.txt */
function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _regeneratorValues(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(_typeof(e)+" is not iterable")}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){c=!0,o=e},f:function(){try{u||null==r.return||r.return()}finally{if(c)throw o}}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function o(r,n,a,o){var l=n&&n.prototype instanceof c?n:c,i=Object.create(l.prototype);return _regeneratorDefine2(i,"_invoke",function(r,n,a){var o,c,l,i=0,s=a||[],g=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return o=t,c=0,l=e,d.n=r,u}};function f(r,n){for(c=r,l=n,t=0;!g&&i&&!a&&t<s.length;t++){var a,o=s[t],f=d.p,m=o[2];r>3?(a=m===n)&&(l=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=r<2&&f<o[1])?(c=0,d.v=n,d.n=o[1]):f<m&&(a=r<3||o[0]>n||n>m)&&(o[4]=r,o[5]=n,d.n=m,c=0))}if(a||r>1)return u;throw g=!0,n}return function(a,s,m){if(i>1)throw TypeError("Generator is already running");for(g&&1===s&&f(s,m),c=s,l=m;(t=c<2?e:l)||!g;){o||(c?c<3?(c>1&&(d.n=-1),f(c,l)):d.n=l:d.v=l);try{if(i=2,o){if(c||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((t=(g=d.n<0)?l:r.call(n,d))!==u)break}catch(t){o=e,c=1,l=t}finally{i=1}}return{value:t,done:g}}}(r,a,o),!0),i}var u={};function c(){}function l(){}function i(){}t=Object.getPrototypeOf;var s=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,(function(){return this})),t),g=i.prototype=c.prototype=Object.create(s);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,i):(e.__proto__=i,_regeneratorDefine2(e,a,"GeneratorFunction")),e.prototype=Object.create(g),e}return l.prototype=i,_regeneratorDefine2(g,"constructor",i),_regeneratorDefine2(i,"constructor",l),l.displayName="GeneratorFunction",_regeneratorDefine2(i,a,"GeneratorFunction"),_regeneratorDefine2(g),_regeneratorDefine2(g,a,"Generator"),_regeneratorDefine2(g,n,(function(){return this})),_regeneratorDefine2(g,"toString",(function(){return"[object Generator]"})),(_regenerator=function(){return{w:o,m:d}})()}function _regeneratorDefine2(e,t,r,n){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}_regeneratorDefine2=function(e,t,r,n){if(t)a?a(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r;else{var o=function(t,r){_regeneratorDefine2(e,t,(function(e){return this._invoke(t,r,e)}))};o("next",0),o("throw",1),o("return",2)}},_regeneratorDefine2(e,t,r,n)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,u,c=[],l=!0,i=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){i=!0,a=e}finally{try{if(!l&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(i)throw a}}return c}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,t,r,n,a,o,u){try{var c=e[o](u),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function u(e){asyncGeneratorStep(o,n,a,u,c,"next",e)}function c(e){asyncGeneratorStep(o,n,a,u,c,"throw",e)}u(void 0)}))}}import{handleCellChange}from"../display/display.js";import{openSettings}from"../settings/settings.js";Office.onReady((function(e){e.host===Office.HostType.Excel&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("generate-ordering-report").onclick=function(){return tryCatch(generateOrderingReport)},document.getElementById("generate-inventory-report").onclick=function(){return tryCatch(generateInventoryReport)},document.getElementById("temp-reset").onclick=function(){return tryCatch(resetAll)},document.getElementById("start-date").addEventListener("input",checkDatesAndClearMessage),document.getElementById("end-date").addEventListener("input",checkDatesAndClearMessage),document.getElementById("order-filtering").addEventListener("change",filteringDropdown),document.getElementById("settings-button").onclick=function(){return tryCatch(openSettings)})}));var orderingWorksheet,orderingTable,filter=[],invFilter=[],earlyDateMap=new Map,startDateMap=new Map,outputJobs=new Set,allData=[];export var matchingData=[];function generateOrderingReport(){return _generateOrderingReport.apply(this,arguments)}function _generateOrderingReport(){return _generateOrderingReport=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var r,n;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return resetGenerateOrdering(),e.n=1,t.sync();case 1:if(orderingWorksheet=t.workbook.worksheets.add("Ordering"),(orderingTable=orderingWorksheet.tables.add("A1:G1",!0)).name="OrderingTable",orderingTable.getHeaderRowRange().values=[["Case #","Demand","Current Inventory","On Order","Required Amount","Buy or Make","Earliest Start Date"]],orderingTable.columns.getItemAt(3).getRange().numberFormat=[["€#,##0.00"]],orderingTable.getRange().format.autofitColumns(),orderingTable.getRange().format.autofitRows(),r=document.getElementById("start-date").value,n=document.getElementById("end-date").value,r&&n){e.n=2;break}return document.getElementById("message-area").textContent="Please enter the dates",e.a(2);case 2:return document.getElementById("message-area").textContent=" ",dateFilter(),e.n=3,t.sync();case 3:importColumnData();case 4:return orderingWorksheet.onSelectionChanged.add(displayData),e.n=5,t.sync();case 5:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_generateOrderingReport.apply(this,arguments)}function generateInventoryReport(){return _generateInventoryReport.apply(this,arguments)}function _generateInventoryReport(){return _generateInventoryReport=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var r,n,a,o;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return resetGenerateInventory(),e.n=1,t.sync();case 1:if(r=t.workbook.worksheets.add("Inventory At"),(n=r.tables.add("A1:J1",!0)).name="InventoryAtTable",n.getHeaderRowRange().values=[["Case #","Demand","Qty MEB","Qty EFW","Total MEB + EFW","On Order","Start Date","Release Date","Qty Needed (MEB)","Notes"]],n.columns.getItemAt(2).getRange().numberFormat=[["€#,##0.00"]],n.getRange().format.autofitColumns(),n.getRange().format.autofitRows(),a=document.getElementById("start-date").value,o=document.getElementById("end-date").value,a&&o){e.n=2;break}return document.getElementById("message-area").textContent="Please enter the dates",e.a(2);case 2:return document.getElementById("message-area").textContent=" ",otherDateFilter(),e.n=3,t.sync();case 3:importOtherColumnData();case 4:return e.n=5,t.sync();case 5:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_generateInventoryReport.apply(this,arguments)}function tryCatch(e){return _tryCatch.apply(this,arguments)}function _tryCatch(){return(_tryCatch=_asyncToGenerator(_regenerator().m((function e(t){var r;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,t();case 1:e.n=3;break;case 2:e.p=2,r=e.v,alert(r),console.error(r);case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function importColumnData(){return _importColumnData.apply(this,arguments)}function _importColumnData(){return _importColumnData=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var r,n,a,o,u,c,l,i,s,g,d,f,m,y,p,h,v,I,_,b,w,R,D,T,k,O,E,x,C,S,A,L,G,B,F,M,N,U,j,H,W,P,J,q,z,V,Q,$,K,X,Y,Z,ee,te,re,ne,ae,oe,ue,ce,le,ie,se,ge,de,fe,me,ye,pe,he,ve,Ie,_e,be,we,Re,De,Te,ke,Oe,Ee,xe,Ce,Se,Ae,Le,Ge,Be,Fe,Me,Ne,Ue,je,He,We,Pe,Je,qe,ze,Ve,Qe;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return r=t.workbook.worksheets.getItem("Inventory"),n=r.getUsedRange().load("values"),a=t.workbook.worksheets.getItem("Dynamic"),o=a.getUsedRange().load("values"),u=t.workbook.worksheets.getItem("Open PO's"),c=u.getUsedRange().load("values"),l=t.workbook.worksheets.getItem("Ordering"),e.n=1,t.sync();case 1:return i=o.values[0],s=i.indexOf("Corrugate"),g=i.indexOf("Number of Corrugate"),d=i.indexOf("Work Center"),f="".concat(colIdxToLetter(s),":").concat(colIdxToLetter(s)),m="".concat(colIdxToLetter(g),":").concat(colIdxToLetter(g)),y="".concat(colIdxToLetter(d),":").concat(colIdxToLetter(d)),p=c.values[0],h=p.indexOf("Item Code"),v=p.indexOf("Outstanding Qty"),I="".concat(colIdxToLetter(h),":").concat(colIdxToLetter(h)),_="".concat(colIdxToLetter(v),":").concat(colIdxToLetter(v)),b=n.values[0],w=b.indexOf("Item Code"),R=b.indexOf("Inventory Qty"),D="".concat(colIdxToLetter(w),":").concat(colIdxToLetter(w)),T="".concat(colIdxToLetter(R),":").concat(colIdxToLetter(R)),k=t.workbook.worksheets.getItem("Dynamic"),O=k.getRange(m).getUsedRange().load("values"),E=k.getRange(f).getUsedRange().load("values"),x=k.getRange(y).getUsedRange().load("values"),e.n=2,t.sync();case 2:return C=r.getRange(D).getUsedRange().load("values"),S=r.getRange(T).getUsedRange().load("values"),A=t.workbook.worksheets.getItem("Open PO's"),L=A.getRange(I).getUsedRange().load("values"),G=A.getRange(_).getUsedRange().load("values"),e.n=3,t.sync();case 3:B=filter.map((function(e){return[e.itemCode]})),F=filter.map((function(e){return[e.qty]})),M=buildSumMap(E.values,O.values),N=buildSumMap(B,F),U=buildSumMap(C.values,S.values),j=buildSumMap(L.values,G.values),H=new Set([].concat(_toConsumableArray(N.keys()),_toConsumableArray(U.keys()),_toConsumableArray(j.keys()))),W=[["Case #","Required Amount"]],P=_createForOfIteratorHelper(H);try{for(P.s();!(J=P.n()).done;)q=J.value,z=N.get(q)||0,V=U.get(q)||0,Q=j.get(q)||0,($=z-V-Q)>0&&W.push([q,$])}catch(e){P.e(e)}finally{P.f()}return K=W.map((function(e){return[e[0]]})),l.getRange("A1:A".concat(K.length)).values=K,X=W.map((function(e){return[e[1]]})),l.getRange("E1:E".concat(X.length)).values=X,e.n=4,t.sync();case 4:Y=[["Case #","Remove From Order"]],Z=_createForOfIteratorHelper(H);try{for(Z.s();!(ee=Z.n()).done;)te=ee.value,re=Number(M.get(te))||0,ne=Number(j.get(te))||0,ae=ne-re,isNaN(re)||isNaN(ne)||String(te).includes("COR")&&ne>re&&Y.push([te,ae])}catch(e){Z.e(e)}finally{Z.f()}return console.log("Sell these",Y),oe=l.getUsedRange().load("values"),e.n=5,t.sync();case 5:for(ue=oe.values,ce=[["Earliest Start Date"]],le=1;le<ue.length;le++)ie=String(ue[le][0]).trim(),se=String(earlyDateMap.get(ie))||"No Start Date Established",ge=se.split(" ").slice(0,4).join(" "),ce.push([ge]);l.getRange("G1:G".concat(ce.length)).values=ce,de=W.map((function(e){return e[0]})),fe=[["Demand"]],me=_createForOfIteratorHelper(de);try{for(me.s();!(ye=me.n()).done;)pe=ye.value,(he=N.get(pe)||0)>0&&fe.push([he])}catch(e){me.e(e)}finally{me.f()}ve=fe.map((function(e){return[e[0]]})),l.getRange("B1:B".concat(ve.length)).values=ve,Ie=[["Current Inventory"]],_e=_createForOfIteratorHelper(de.slice(1));try{for(_e.s();!(be=_e.n()).done;)we=be.value,Re=U.get(we)||0,Ie.push([Re])}catch(e){_e.e(e)}finally{_e.f()}De=Ie.map((function(e){return[e[0]]})),l.getRange("C1:C".concat(De.length)).values=De,Te=[["On Order"]],ke=_createForOfIteratorHelper(de.slice(1));try{for(ke.s();!(Oe=ke.n()).done;)Ee=Oe.value,xe=j.get(Ee)||0,Te.push([xe])}catch(e){ke.e(e)}finally{ke.f()}for(Ce=Te.map((function(e){return[e[0]]})),l.getRange("D1:D".concat(Ce.length)).values=Ce,Se=new Map,Ae=1;Ae<E.values.length;Ae++)Le=String(E.values[Ae][0]).trim(),Ge=x.values[Ae]?String(x.values[Ae][0]).trim():"",Le&&Ge&&(Se.has(Le)||Se.set(Le,new Set),Se.get(Le).add(Ge));return e.n=6,t.sync();case 6:Be=[["Buy or Make"]],Fe=_createForOfIteratorHelper(de.slice(1));try{for(Fe.s();!(Me=Fe.n()).done;)Ne=Me.value,Ue=Se.get(Ne),je=Ue?Array.from(Ue).join(", "):"",Be.push([je])}catch(e){Fe.e(e)}finally{Fe.f()}He=Be.map((function(e){return[e[0]]})),We=[["Buy or Make"]],Pe=1;case 7:if(!(Pe<He.length)){e.n=9;break}return(Je=He[Pe][0]).includes("40FGAL3A")||Je.includes("40FGAL3B")||Je.includes("40FGAL3C")||Je.includes("40FGSI2A")||Je.includes("40AIFG2B")?We.push(["Must Buy"]):Number(X[Pe][0])>=300?We.push(["Can Buy"]):We.push(["Can Make"]),e.n=8,t.sync();case 8:Pe++,e.n=7;break;case 9:return l.getRange("F1:F".concat(We.length)).values=We,l.getRange("A:G").format.autofitColumns(),l.getRange("A:H").format.horizontalAlignment="Center",l.getRange("A:H").format.verticalAlignment="Center",l.getRange("D:D").numberFormat=[["General"]],l.getRange("A:A").format.columnWidth=150,l.getRange("B:B").format.columnWidth=90,l.getRange("C:C").format.columnWidth=120,l.getRange("D:D").format.columnWidth=90,l.getRange("E:E").format.columnWidth=130,l.getRange("F:F").format.columnWidth=100,l.getRange("B:B").format.columnWidth=130,l.getUsedRange().format.rowHeight=30,l.freezePanes.freezeRows(1),l.getRange("E1:E1").format.fill.color="#BE5014",l.getRange("E1:E1").format.font.color="yellow",qe=l.getUsedRange(),ze=qe.format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight","InsideVertical","InsideHorizontal"].forEach((function(e){ze.getItem(e).style="Continuous",ze.getItem(e).weight="Thin",ze.getItem(e).color="#000000"})),Ve=ve.length,Qe=l.getRange("E1:E".concat(Ve)).format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight"].forEach((function(e){Qe.getItem(e).style="Continuous",Qe.getItem(e).weight="Thick",Qe.getItem(e).color="#BE5014"})),e.n=10,t.sync();case 10:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_importColumnData.apply(this,arguments)}function importOtherColumnData(e){return _importOtherColumnData.apply(this,arguments)}function _importOtherColumnData(){return _importOtherColumnData=_asyncToGenerator(_regenerator().m((function e(t){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var r,n,a,o,u,c,l,i,s,g,d,f,m,y,p,h,v,I,_,b,w,R,D,T,k,O,E,x,C,S,A,L,G,B,F,M,N,U,j,H,W,P,J,q,z,V,Q,$,K,X,Y,Z,ee,te,re,ne,ae,oe,ue,ce,le,ie,se,ge,de,fe,me,ye,pe,he,ve,Ie,_e,be,we;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return r=t.workbook.worksheets.getItem("Inventory"),n=r.getUsedRange().load("values"),a=t.workbook.worksheets.getItem("Dynamic"),o=a.getUsedRange().load("values"),u=t.workbook.worksheets.getItem("Open PO's"),c=u.getUsedRange().load("values"),l=t.workbook.worksheets.getItem("Inventory At"),e.n=1,t.sync();case 1:return i=o.values[0],s=i.indexOf("Corrugate"),g=i.indexOf("Number of Corrugate"),"".concat(colIdxToLetter(s),":").concat(colIdxToLetter(s)),"".concat(colIdxToLetter(g),":").concat(colIdxToLetter(g)),d=c.values[0],f=d.indexOf("Item Code"),m=d.indexOf("Outstanding Qty"),y="".concat(colIdxToLetter(f),":").concat(colIdxToLetter(f)),p="".concat(colIdxToLetter(m),":").concat(colIdxToLetter(m)),h=n.values[0],v=h.indexOf("Item Code"),I=h.indexOf("Inventory Qty"),_=h.indexOf("Location"),b="".concat(colIdxToLetter(v),":").concat(colIdxToLetter(v)),w="".concat(colIdxToLetter(I),":").concat(colIdxToLetter(I)),R="".concat(colIdxToLetter(_),":").concat(colIdxToLetter(_)),e.n=2,t.sync();case 2:return D=r.getRange(b).getUsedRange().load("values"),T=r.getRange(w).getUsedRange().load("values"),k=r.getRange(R).getUsedRange().load("values"),O=t.workbook.worksheets.getItem("Open PO's"),E=O.getRange(y).getUsedRange().load("values"),x=O.getRange(p).getUsedRange().load("values"),e.n=3,t.sync();case 3:C=invFilter.map((function(e){return[e.itemCode]})),S=invFilter.map((function(e){return[e.qty]})),A=buildSumMap(C,S),L=[["Case #","Demand"]],G=_createForOfIteratorHelper(A.keys());try{for(G.s();!(B=G.n()).done;)F=B.value,(M=A.get(F)||0)>0&&L.push([F,M])}catch(e){G.e(e)}finally{G.f()}return e.n=4,t.sync();case 4:for(N=L.map((function(e){return e[0]})),l.getRange("A1:A".concat(N.length)).values=N.map((function(e){return[e]})),U=L.map((function(e){return[e[1]]})),console.log("Required Amounts",U),l.getRange("B1:B".concat(U.length)).values=U,j=[],H=[],W=0;W<N.length;W++){for(P=String(N[W]).trim(),J=!1,q=0;q<D.values.length;q++)z=String(D.values[q][0]).trim(),V=String(k.values[q][0]).trim(),Q=Number(T.values[q][0]),P===z&&($=V.includes("MEB"),K=V.includes("EFW"),j.push([P,$?Q:0]),H.push([P,K?Q:0]),J=!0);J||(j.push([P,0]),H.push([P,0]))}return e.n=5,t.sync();case 5:X=buildSumMap(j.map((function(e){return[e[0]]})),j.map((function(e){return[e[1]]}))),Y=Array.from(X.entries()).map((function(e){return[e[1]]})),l.getRange("C2:C".concat(Y.length+1)).values=Y,Z=buildSumMap(H.map((function(e){return[e[0]]})),H.map((function(e){return[e[1]]}))),ee=Array.from(Z.entries()).map((function(e){return[e[1]]})),l.getRange("D2:D".concat(ee.length+1)).values=ee,te=Y.map((function(e,t){return Number(e)+ee[t][0]})),l.getRange("E2:E".concat(te.length+1)).values=te.map((function(e){return[e]})),re=buildSumMap(E.values,x.values),ne=[["On Order"]],ae=_createForOfIteratorHelper(N.slice(1));try{for(ae.s();!(oe=ae.n()).done;)ue=oe.value,ce=re.get(ue)||0,ne.push([ce])}catch(e){ae.e(e)}finally{ae.f()}for(le=ne.map((function(e){return[e[0]]})),l.getRange("F1:F".concat(le.length)).values=le,ie=[["Earliest Start Date"]],se=[["Release Date"]],ge=1;ge<N.length;ge++)de=String(N[ge]).trim(),fe=String(startDateMap.get(de))||"No Start Date Established",me=fe.split(" ").slice(0,4).join(" "),ie.push([me]),ye=new Date(fe),isNaN(ye)?se.push(["Invalid Release Date"]):(ye.setDate(ye.getDate()-10),pe=ye.toDateString(),se.push([pe]));return l.getRange("G1:G".concat(ie.length)).values=ie,l.getRange("H1:H".concat(se.length)).values=se,he=U.slice(1).map((function(e,t){return Number(e)-Y[t]})),l.getRange("I2:I".concat(he.length+1)).values=he.map((function(e){return[e]})),e.n=6,t.sync();case 6:for(ve=he.length-1;ve>=0;ve--)he[ve]<=0?l.getRange("I".concat(ve+2)).getEntireRow().delete(ExcelScript.DeleteShiftDirection.up):l.getRange("I".concat(ve+2)).setValue(he[ve]);return l.getRange("A:J").format.autofitColumns(),l.getRange("A:J").format.horizontalAlignment="Center",l.getRange("A:J").format.verticalAlignment="Center",l.getRange("C:C").numberFormat=[["General"]],l.getRange("A:A").format.columnWidth=120,l.getRange("B:B").format.columnWidth=70,l.getRange("C:C").format.columnWidth=70,l.getRange("D:D").format.columnWidth=70,l.getRange("E:E").format.columnWidth=100,l.getRange("F:F").format.columnWidth=75,l.getRange("G:G").format.columnWidth=90,l.getRange("H:H").format.columnWidth=90,l.getRange("I:I").format.columnWidth=130,l.getRange("J:J").format.columnWidth=150,l.getUsedRange().format.rowHeight=20,l.freezePanes.freezeRows(1),l.getRange("I1:I1").format.fill.color="#BE5014",l.getRange("I1:I1").format.font.color="yellow",Ie=l.getUsedRange(),_e=Ie.format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight","InsideVertical","InsideHorizontal"].forEach((function(e){_e.getItem(e).style="Continuous",_e.getItem(e).weight="Thin",_e.getItem(e).color="#000000"})),be=Y.length,we=l.getRange("I1:I".concat(be+1)).format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight"].forEach((function(e){we.getItem(e).style="Continuous",we.getItem(e).weight="Thick",we.getItem(e).color="#BE5014"})),e.n=7,t.sync();case 7:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_importOtherColumnData.apply(this,arguments)}function resetAll(){return _resetAll.apply(this,arguments)}function _resetAll(){return _resetAll=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var r;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return(r=t.workbook.worksheets).getItemOrNullObject("Ordering").delete(),r.getItemOrNullObject("Inventory At").delete(),r.getItemOrNullObject("Test").delete(),document.getElementById("start-date").value="",document.getElementById("end-date").value="",e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_resetAll.apply(this,arguments)}function resetGenerateOrdering(){return _resetGenerateOrdering.apply(this,arguments)}function _resetGenerateOrdering(){return _resetGenerateOrdering=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.getItemOrNullObject("Ordering").delete(),filter=[],earlyDateMap.clear(),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_resetGenerateOrdering.apply(this,arguments)}function resetGenerateInventory(){return _resetGenerateInventory.apply(this,arguments)}function _resetGenerateInventory(){return _resetGenerateInventory=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.getItemOrNullObject("Inventory At").delete(),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_resetGenerateInventory.apply(this,arguments)}function colIdxToLetter(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}function buildSumMap(e,t){for(var r=new Map,n=1;n<e.length;n++){var a=e[n][0],o=Number(t[n][0]);a&&!isNaN(o)&&r.set(a,(r.get(a)||0)+o)}return r}function dateFilter(){return _dateFilter.apply(this,arguments)}function _dateFilter(){return _dateFilter=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var r,n,a,o,u,c,l,i,s,g,d,f,m,y,p,h,v,I,_,b,w,R,D,T,k,O,E,x,C,S,A,L,G,B,F,M,N,U;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return r=document.getElementById("start-date").value,n=document.getElementById("end-date").value,a=inputDateParse(r),o=inputDateParse(n),u=t.workbook.worksheets.getItem("Dynamic"),c=u.getUsedRange().load("values"),e.n=1,t.sync();case 1:return l=c.values[0],i=l.indexOf("Corrugate"),s=l.indexOf("Planned Start"),g=l.indexOf("Number of Corrugate"),d=l.indexOf("Order Number"),f="".concat(colIdxToLetter(s),":").concat(colIdxToLetter(s)),m="".concat(colIdxToLetter(g),":").concat(colIdxToLetter(g)),y="".concat(colIdxToLetter(i),":").concat(colIdxToLetter(i)),p="".concat(colIdxToLetter(d),":").concat(colIdxToLetter(d)),h=t.workbook.worksheets.getItem("Dynamic"),v=h.getRange(y).getUsedRange().load("values"),I=h.getRange(m).getUsedRange().load("values"),_=u.getRange(f).getUsedRange().load("values"),b=u.getRange(p).getUsedRange().load("values"),e.n=2,t.sync();case 2:for(w=new Map,R=1;R<v.values.length;R++)D=String(v.values[R][0]).trim(),T=_.values[R]?String(_.values[R][0]).trim():"",(k=ExcelDateToJSDate(T)).setHours(0,0,0,0),O=String(b.values[R][0]).trim(),E=Number(I.values[R][0]),D&&k>=a&&k<=o&&(!w.has(O)||k>w.get(O).date)&&w.set(O,{itemCode:D,qty:E,date:k,job:O});filter=Array.from(w.values()),earlyDateMap.clear(),x=_createForOfIteratorHelper(filter);try{for(x.s();!(C=x.n()).done;)S=C.value,A=S.itemCode,L=S.date,(!earlyDateMap.has(A)||L<earlyDateMap.get(A))&&earlyDateMap.set(A,L)}catch(e){x.e(e)}finally{x.f()}return filter.sort((function(e,t){return e.date-t.date})),e.n=3,t.sync();case 3:for(G=1;G<v.values.length;G++)B=String(v.values[G][0]).trim(),F=_.values[G]?String(_.values[G][0]).trim():"",(M=ExcelDateToJSDate(F)).setHours(0,0,0,0),N=String(b.values[G][0]).trim(),U=Number(I.values[G][0]),B&&allData.push({itemCode:B,qty:U,job:N,date:M});case 4:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_dateFilter.apply(this,arguments)}function otherDateFilter(){return _otherDateFilter.apply(this,arguments)}function _otherDateFilter(){return _otherDateFilter=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var r,n,a,o,u,c,l,i,s,g,d,f,m,y,p,h,v,I,_,b,w,R,D,T,k,O,E,x,C,S,A,L;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return r=document.getElementById("start-date").value,n=document.getElementById("end-date").value,a=inputDateParse(r),o=inputDateParse(n),u=t.workbook.worksheets.getItem("Dynamic"),c=u.getUsedRange().load("values"),e.n=1,t.sync();case 1:return l=c.values[0],i=l.indexOf("Corrugate"),s=l.indexOf("Planned Start"),g=l.indexOf("Number of Corrugate"),d=l.indexOf("Order Number"),f="".concat(colIdxToLetter(s),":").concat(colIdxToLetter(s)),m="".concat(colIdxToLetter(g),":").concat(colIdxToLetter(g)),y="".concat(colIdxToLetter(i),":").concat(colIdxToLetter(i)),p="".concat(colIdxToLetter(d),":").concat(colIdxToLetter(d)),h=t.workbook.worksheets.getItem("Dynamic"),v=h.getRange(y).getUsedRange().load("values"),I=h.getRange(m).getUsedRange().load("values"),_=u.getRange(f).getUsedRange().load("values"),b=u.getRange(p).getUsedRange().load("values"),e.n=2,t.sync();case 2:for(w=new Map,R=1;R<v.values.length;R++)D=String(v.values[R][0]).trim(),T=_.values[R]?String(_.values[R][0]).trim():"",(k=ExcelDateToJSDate(T)).setHours(0,0,0,0),O=String(b.values[R][0]).trim(),E=Number(I.values[R][0]),D&&k>=a&&k<=o&&(!w.has(O)||k>w.get(O).date)&&w.set(O,{itemCode:D,qty:E,date:k,job:O});invFilter=Array.from(w.values()),startDateMap.clear(),x=_createForOfIteratorHelper(invFilter);try{for(x.s();!(C=x.n()).done;)S=C.value,A=S.itemCode,L=S.date,(!startDateMap.has(A)||L<startDateMap.get(A))&&startDateMap.set(A,L)}catch(e){x.e(e)}finally{x.f()}return invFilter.sort((function(e,t){return e.date-t.date})),e.n=3,t.sync();case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_otherDateFilter.apply(this,arguments)}function inputDateParse(e){var t=_slicedToArray(e.split("-").map(Number),3),r=t[0],n=t[1],a=t[2];return new Date(r,n-1,a)}function ExcelDateToJSDate(e){var t=new Date(86400*(e-25569)*1e3);return new Date(t.getTime()+6e4*t.getTimezoneOffset())}function checkDatesAndClearMessage(){var e=document.getElementById("start-date").value,t=document.getElementById("end-date").value;e&&t&&(document.getElementById("message-area").textContent="")}function displayData(e){return _displayData.apply(this,arguments)}function _displayData(){return _displayData=_asyncToGenerator(_regenerator().m((function e(t){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(r){var n,a,o,u,c,l,i,s,g;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=r.workbook.worksheets.getItem("Ordering"),(a=n.getRange(t.address)).load(["columnIndex","values","address"]),e.n=1,r.sync();case 1:if(console.log("Index Number",a.columnIndex),outputJobs.clear(),0!=a.columnIndex){e.n=5;break}matchingData.length=0,o=a.values[0],u=allData.map((function(e){return[e.itemCode]})),c=allData.map((function(e){return[e.job]})),l=allData.map((function(e){return[e.qty]})),i=allData.map((function(e){return[e.date]})),s=_regenerator().m((function e(){var t,r,n,a,s,d,f;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:t=u[g][0],r=c[g][0],n=l[g][0],a=i[g][0],s=formatDate(a),o==t&&(outputJobs.has(r)?(d=earlyDateMap.get(t),-1!==(f=matchingData.findIndex((function(e){return e.job===r&&e.code===t})))&&(matchingData[f].date=d)):(matchingData.push({code:t,job:r,qty:n,fDate:s}),outputJobs.add(r)));case 1:return e.a(2)}}),e)})),g=0;case 2:if(!(g<u.length)){e.n=4;break}return e.d(_regeneratorValues(s()),3);case 3:g++,e.n=2;break;case 4:console.log("intial finding of Matching Data",matchingData),handleCellChange([].concat(matchingData)),matchingData.sort((function(e,t){return e.date-t.date})),localStorage.setItem("matchingData",JSON.stringify(matchingData)),e.n=6;break;case 5:console.log("Not in range");case 6:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_displayData.apply(this,arguments)}function filteringDropdown(){return _filteringDropdown.apply(this,arguments)}function _filteringDropdown(){return _filteringDropdown=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var r,n,a,o,u;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:r=t.workbook.worksheets.getItem("Ordering"),n=r.tables.getItem("OrderingTable"),a=n.columns.getItem("Required Amount").filter,o=n.columns.getItem("Buy or Make").filter,u=document.getElementById("order-filtering").value,e.n="Intial"===u?1:"over-300"===u?2:"Must-buy"===u?3:"Can-buy"===u?4:"Can-make"===u?5:6;break;case 1:return console.log("no changes made"),a.clear(),o.clear(),e.a(3,7);case 2:return a.clear(),o.clear(),a.applyCustomFilter(">=300"),e.a(3,7);case 3:return a.clear(),o.clear(),o.applyValuesFilter(["Must Buy"]),e.a(3,7);case 4:return a.clear(),o.clear(),o.applyValuesFilter(["Can Buy"]),e.a(3,7);case 5:return a.clear(),o.clear(),o.applyValuesFilter(["Can Make"]),e.a(3,7);case 6:return console.log("No valid filter selected"),e.a(3,7);case 7:return e.n=8,t.sync();case 8:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_filteringDropdown.apply(this,arguments)}function formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-")}