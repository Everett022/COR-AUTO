/*! For license information please see e6cc44e6ae8d58470ecf.js.LICENSE.txt */
function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _regeneratorValues(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(_typeof(e)+" is not iterable")}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){u=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(u)throw o}}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _regenerator(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var s=r&&r.prototype instanceof u?r:u,l=Object.create(s.prototype);return _regeneratorDefine2(l,"_invoke",function(n,r,a){var o,u,s,l=0,i=a||[],g=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,u=0,s=e,d.n=n,c}};function f(n,r){for(u=n,s=r,t=0;!g&&l&&!a&&t<i.length;t++){var a,o=i[t],f=d.p,m=o[2];n>3?(a=m===r)&&(s=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=n<2&&f<o[1])?(u=0,d.v=r,d.n=o[1]):f<m&&(a=n<3||o[0]>r||r>m)&&(o[4]=n,o[5]=r,d.n=m,u=0))}if(a||n>1)return c;throw g=!0,r}return function(a,i,m){if(l>1)throw TypeError("Generator is already running");for(g&&1===i&&f(i,m),u=i,s=m;(t=u<2?e:s)||!g;){o||(u?u<3?(u>1&&(d.n=-1),f(u,s)):d.n=s:d.v=s);try{if(l=2,o){if(u||(a="next"),t=o[a]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,u<2&&(u=0)}else 1===u&&(t=o.return)&&t.call(o),u<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),u=1);o=e}else if((t=(g=d.n<0)?s:n.call(r,d))!==c)break}catch(t){o=e,u=1,s=t}finally{l=1}}return{value:t,done:g}}}(n,a,o),!0),l}var c={};function u(){}function s(){}function l(){}t=Object.getPrototypeOf;var i=[][r]?t(t([][r]())):(_regeneratorDefine2(t={},r,(function(){return this})),t),g=l.prototype=u.prototype=Object.create(i);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,_regeneratorDefine2(e,a,"GeneratorFunction")),e.prototype=Object.create(g),e}return s.prototype=l,_regeneratorDefine2(g,"constructor",l),_regeneratorDefine2(l,"constructor",s),s.displayName="GeneratorFunction",_regeneratorDefine2(l,a,"GeneratorFunction"),_regeneratorDefine2(g),_regeneratorDefine2(g,a,"Generator"),_regeneratorDefine2(g,r,(function(){return this})),_regeneratorDefine2(g,"toString",(function(){return"[object Generator]"})),(_regenerator=function(){return{w:o,m:d}})()}function _regeneratorDefine2(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}_regeneratorDefine2=function(e,t,n,r){if(t)a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var o=function(t,n){_regeneratorDefine2(e,t,(function(e){return this._invoke(t,n,e)}))};o("next",0),o("throw",1),o("return",2)}},_regeneratorDefine2(e,t,n,r)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,c,u=[],s=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(e){l=!0,a=e}finally{try{if(!s&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(l)throw a}}return u}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,t,n,r,a,o,c){try{var u=e[o](c),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){asyncGeneratorStep(o,r,a,c,u,"next",e)}function u(e){asyncGeneratorStep(o,r,a,c,u,"throw",e)}c(void 0)}))}}import{handleCellChange}from"../display/display.js";import{openSettings}from"../settings/settings.js";Office.onReady((function(e){e.host===Office.HostType.Excel&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("generate-ordering-report").onclick=function(){return tryCatch(generateOrderingReport)},document.getElementById("generate-inventory-report").onclick=function(){return tryCatch(generateInventoryReport)},document.getElementById("start-date").addEventListener("input",checkDatesAndClearMessage),document.getElementById("end-date").addEventListener("input",checkDatesAndClearMessage),document.getElementById("order-filtering").addEventListener("change",filteringDropdown),document.getElementById("inventory-filtering").addEventListener("change",invFilteringDropdown),document.getElementById("settings-button").onclick=function(){return tryCatch(openSettings)},setInterval((function(){test().catch(console.error)}),5e3))}));var orderingWorksheet,orderingTable,filter=[],invFilter=[],earlyDateMap=new Map,startDateMap=new Map,outputJobs=new Set,allData=[];export var matchingData=[];function generateOrderingReport(){return _generateOrderingReport.apply(this,arguments)}function _generateOrderingReport(){return _generateOrderingReport=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return resetGenerateOrdering(),e.n=1,t.sync();case 1:if(orderingWorksheet=t.workbook.worksheets.add("Ordering"),(orderingTable=orderingWorksheet.tables.add("A1:G1",!0)).name="OrderingTable",orderingTable.getHeaderRowRange().values=[["Case #","Demand","Current Inventory","On Order","Required Amount","Buy or Make","Earliest Start Date"]],orderingTable.columns.getItemAt(3).getRange().numberFormat=[["€#,##0.00"]],orderingTable.getRange().format.autofitColumns(),orderingTable.getRange().format.autofitRows(),n=document.getElementById("start-date").value,r=document.getElementById("end-date").value,n&&r){e.n=2;break}return document.getElementById("message-area").textContent="Please enter the dates",e.a(2);case 2:return document.getElementById("message-area").textContent=" ",dateFilter(),e.n=3,t.sync();case 3:return importColumnData(),e.n=4,t.sync();case 4:return orderingWorksheet.onSelectionChanged.add(displayData),e.n=5,t.sync();case 5:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_generateOrderingReport.apply(this,arguments)}function generateInventoryReport(){return _generateInventoryReport.apply(this,arguments)}function _generateInventoryReport(){return _generateInventoryReport=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,a,o,c,u;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return resetGenerateInventory(),e.n=1,t.sync();case 1:if(n=t.workbook.worksheets.add("Inventory At"),r=n.tables.add("A1:J1",!0),a=t.workbook.worksheets.add("Inventory Request"),o=a.tables.add("A1:D1",!0),r.name="InventoryAtTable",r.style="TableStyleMedium10",o.name="InventoryReadoutTable",o.style="TableStyleMedium10",o.getHeaderRowRange().values=[["Item Code","Inventory Date","Inventory Ref","Inventory Qty"]],r.getHeaderRowRange().values=[["Case #","Demand","Qty MEB","Qty EFW","Total MEB + EFW","On Order","Start Date","Release Date","Qty Needed (MEB)","Notes"]],r.columns.getItemAt(2).getRange().numberFormat=[["€#,##0.00"]],r.getRange().format.autofitColumns(),r.getRange().format.autofitRows(),c=document.getElementById("start-date").value,u=document.getElementById("end-date").value,c&&u){e.n=2;break}return document.getElementById("message-area").textContent="Please enter the dates",e.a(2);case 2:return document.getElementById("message-area").textContent=" ",otherDateFilter(),e.n=3,t.sync();case 3:return importOtherColumnData(),e.n=4,t.sync();case 4:return e.n=5,importColumnData();case 5:readoutData();case 6:return e.n=7,t.sync();case 7:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_generateInventoryReport.apply(this,arguments)}function tryCatch(e){return _tryCatch.apply(this,arguments)}function _tryCatch(){return(_tryCatch=_asyncToGenerator(_regenerator().m((function e(t){var n,r;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,t();case 1:e.n=3;break;case 2:e.p=2,r=e.v,(n=document.getElementById("message-area"))&&(n.textContent="Error: ".concat(r.message||r),n.style.color="red",setTimeout((function(){n.textContent="",n.style.color=""}),5e3)),console.error(r);case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function importColumnData(){return _importColumnData.apply(this,arguments)}function _importColumnData(){return _importColumnData=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,a,o,c,u,s,l,i,g,d,f,m,y,R,p,h,v,C,_,O,I,b,D,w,T,M,k,E,x,S,A,L,F,B,N,G,U,H,P,W,j,q,Q,J,V,z,K,X,Y,$,Z,ee,te,ne,re,ae,oe,ce,ue,se,le,ie,ge,de,fe,me,ye,Re,pe,he,ve,Ce,_e,Oe,Ie,be,De,we,Te,Me,ke,Ee,xe,Se,Ae,Le,Fe,Be,Ne,Ge,Ue,He,Pe,We,je,qe,Qe,Je,Ve,ze;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getItem("Inventory"),r=n.getUsedRange().load("values"),a=t.workbook.worksheets.getItem("Dynamic"),o=a.getUsedRange().load("values"),c=t.workbook.worksheets.getItem("Open PO's"),u=c.getUsedRange().load("values"),s=t.workbook.worksheets.getItem("Ordering"),e.n=1,t.sync();case 1:return l=o.values[0],i=l.indexOf("Corrugate"),g=l.indexOf("Number of Corrugate"),d=l.indexOf("Work Center"),f="".concat(colIdxToLetter(i),":").concat(colIdxToLetter(i)),m="".concat(colIdxToLetter(g),":").concat(colIdxToLetter(g)),y="".concat(colIdxToLetter(d),":").concat(colIdxToLetter(d)),R=u.values[0],p=R.indexOf("Item Code"),h=R.indexOf("Outstanding Qty"),v="".concat(colIdxToLetter(p),":").concat(colIdxToLetter(p)),C="".concat(colIdxToLetter(h),":").concat(colIdxToLetter(h)),_=r.values[0],O=_.indexOf("Item Code"),I=_.indexOf("Inventory Qty"),b="".concat(colIdxToLetter(O),":").concat(colIdxToLetter(O)),D="".concat(colIdxToLetter(I),":").concat(colIdxToLetter(I)),w=t.workbook.worksheets.getItem("Dynamic"),T=w.getRange(m).getUsedRange().load("values"),M=w.getRange(f).getUsedRange().load("values"),k=w.getRange(y).getUsedRange().load("values"),e.n=2,t.sync();case 2:return E=n.getRange(b).getUsedRange().load("values"),x=n.getRange(D).getUsedRange().load("values"),S=t.workbook.worksheets.getItem("Open PO's"),A=S.getRange(v).getUsedRange().load("values"),L=S.getRange(C).getUsedRange().load("values"),e.n=3,t.sync();case 3:F=filter.map((function(e){return[e.itemCode]})),B=filter.map((function(e){return[e.qty]})),N=buildSumMap(M.values,T.values),G=buildSumMap(F,B),U=buildSumMap(E.values,x.values),H=buildSumMap(A.values,L.values),P=new Set([].concat(_toConsumableArray(G.keys()),_toConsumableArray(U.keys()),_toConsumableArray(H.keys()))),W=[["Case #","Required Amount"]],j=_createForOfIteratorHelper(P);try{for(j.s();!(q=j.n()).done;)Q=q.value,J=G.get(Q)||0,V=U.get(Q)||0,z=H.get(Q)||0,(K=J-V-z)>0&&W.push([Q,K])}catch(e){j.e(e)}finally{j.f()}return X=W.map((function(e){return[e[0]]})),s.getRange("A1:A".concat(X.length)).values=X,Y=W.map((function(e){return[e[1]]})),s.getRange("E1:E".concat(Y.length)).values=Y,e.n=4,t.sync();case 4:$=[["Case #","Remove From Order"]],Z=_createForOfIteratorHelper(P);try{for(Z.s();!(ee=Z.n()).done;)te=ee.value,ne=Number(N.get(te))||0,re=Number(H.get(te))||0,ae=re-ne,isNaN(ne)||isNaN(re)||String(te).includes("COR")&&re>ne&&$.push([te,ae])}catch(e){Z.e(e)}finally{Z.f()}return console.log("Sell these",$),oe=s.getUsedRange().load("values"),e.n=5,t.sync();case 5:for(ce=oe.values,ue=[["Earliest Start Date"]],se=1;se<ce.length;se++)le=String(ce[se][0]).trim(),ie=String(earlyDateMap.get(le))||"No Start Date Established",ge=ie.split(" ").slice(0,4).join(" "),ue.push([ge]);s.getRange("G1:G".concat(ue.length)).values=ue,de=W.map((function(e){return e[0]})),fe=[["Demand"]],me=_createForOfIteratorHelper(de);try{for(me.s();!(ye=me.n()).done;)Re=ye.value,(pe=G.get(Re)||0)>0&&fe.push([pe])}catch(e){me.e(e)}finally{me.f()}he=fe.map((function(e){return[e[0]]})),s.getRange("B1:B".concat(he.length)).values=he,ve=[["Current Inventory"]],Ce=_createForOfIteratorHelper(de.slice(1));try{for(Ce.s();!(_e=Ce.n()).done;)Oe=_e.value,Ie=U.get(Oe)||0,ve.push([Ie])}catch(e){Ce.e(e)}finally{Ce.f()}be=ve.map((function(e){return[e[0]]})),s.getRange("C1:C".concat(be.length)).values=be,De=[["On Order"]],we=_createForOfIteratorHelper(de.slice(1));try{for(we.s();!(Te=we.n()).done;)Me=Te.value,ke=H.get(Me)||0,De.push([ke])}catch(e){we.e(e)}finally{we.f()}for(Ee=De.map((function(e){return[e[0]]})),s.getRange("D1:D".concat(Ee.length)).values=Ee,xe=new Map,Se=1;Se<M.values.length;Se++)Ae=String(M.values[Se][0]).trim(),Le=k.values[Se]?String(k.values[Se][0]).trim():"",Ae&&Le&&(xe.has(Ae)||xe.set(Ae,new Set),xe.get(Ae).add(Le));return e.n=6,t.sync();case 6:Fe=[["Buy or Make"]],Be=_createForOfIteratorHelper(de.slice(1));try{for(Be.s();!(Ne=Be.n()).done;)Ge=Ne.value,Ue=xe.get(Ge),He=Ue?Array.from(Ue).join(", "):"",Fe.push([He])}catch(e){Be.e(e)}finally{Be.f()}Pe=Fe.map((function(e){return[e[0]]})),We=[["Buy or Make"]],je=1;case 7:if(!(je<Pe.length)){e.n=9;break}return(qe=Pe[je][0]).includes("40FGAL3A")||qe.includes("40FGAL3B")||qe.includes("40FGAL3C")||qe.includes("40FGSI2A")||qe.includes("40AIFG2B")?We.push(["Must Buy"]):Number(Y[je][0])>=300?We.push(["Can Buy"]):We.push(["Can Make"]),e.n=8,t.sync();case 8:je++,e.n=7;break;case 9:return s.getRange("F1:F".concat(We.length)).values=We,s.getRange("A:G").format.autofitColumns(),s.getRange("A:H").format.horizontalAlignment="Center",s.getRange("A:H").format.verticalAlignment="Center",s.getRange("D:D").numberFormat=[["General"]],s.getRange("A:A").format.columnWidth=150,s.getRange("B:B").format.columnWidth=90,s.getRange("C:C").format.columnWidth=120,s.getRange("D:D").format.columnWidth=90,s.getRange("E:E").format.columnWidth=130,s.getRange("F:F").format.columnWidth=100,s.getRange("B:B").format.columnWidth=130,s.getUsedRange().format.rowHeight=30,s.freezePanes.freezeRows(1),s.getRange("E1:E1").format.fill.color="#BE5014",s.getRange("E1:E1").format.font.color="yellow",Qe=s.getUsedRange(),Je=Qe.format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight","InsideVertical","InsideHorizontal"].forEach((function(e){Je.getItem(e).style="Continuous",Je.getItem(e).weight="Thin",Je.getItem(e).color="#000000"})),Ve=he.length,ze=s.getRange("E1:E".concat(Ve)).format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight"].forEach((function(e){ze.getItem(e).style="Continuous",ze.getItem(e).weight="Thick",ze.getItem(e).color="#BE5014"})),e.n=10,t.sync();case 10:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_importColumnData.apply(this,arguments)}function importOtherColumnData(e){return _importOtherColumnData.apply(this,arguments)}function _importOtherColumnData(){return _importOtherColumnData=_asyncToGenerator(_regenerator().m((function e(t){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,a,o,c,u,s,l,i,g,d,f,m,y,R,p,h,v,C,_,O,I,b,D,w,T,M,k,E,x,S,A,L,F,B,N,G,U,H,P,W,j,q,Q,J,V,z,K,X,Y,$,Z,ee,te,ne,re,ae,oe,ce,ue,se,le,ie,ge,de,fe,me,ye,Re,pe,he,ve,Ce,_e,Oe,Ie,be,De,we,Te,Me,ke,Ee,xe,Se;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getItem("Inventory"),r=n.getUsedRange().load("values"),a=t.workbook.worksheets.getItem("Dynamic"),o=a.getUsedRange().load("values"),c=t.workbook.worksheets.getItem("Open PO's"),u=c.getUsedRange().load("values"),s=t.workbook.worksheets.getItem("Inventory At"),e.n=1,t.sync();case 1:return l=o.values[0],i=l.indexOf("Corrugate"),g=l.indexOf("Number of Corrugate"),"".concat(colIdxToLetter(i),":").concat(colIdxToLetter(i)),"".concat(colIdxToLetter(g),":").concat(colIdxToLetter(g)),d=u.values[0],f=d.indexOf("Item Code"),m=d.indexOf("Outstanding Qty"),y="".concat(colIdxToLetter(f),":").concat(colIdxToLetter(f)),R="".concat(colIdxToLetter(m),":").concat(colIdxToLetter(m)),p=r.values[0],h=p.indexOf("Item Code"),v=p.indexOf("Inventory Qty"),C=p.indexOf("Location"),_="".concat(colIdxToLetter(h),":").concat(colIdxToLetter(h)),O="".concat(colIdxToLetter(v),":").concat(colIdxToLetter(v)),I="".concat(colIdxToLetter(C),":").concat(colIdxToLetter(C)),e.n=2,t.sync();case 2:return b=n.getRange(_).getUsedRange().load("values"),D=n.getRange(O).getUsedRange().load("values"),w=n.getRange(I).getUsedRange().load("values"),T=t.workbook.worksheets.getItem("Open PO's"),M=T.getRange(y).getUsedRange().load("values"),k=T.getRange(R).getUsedRange().load("values"),e.n=3,t.sync();case 3:E=invFilter.map((function(e){return[e.itemCode]})),x=invFilter.map((function(e){return[e.qty]})),S=buildSumMap(E,x),A=[["Case #","Demand"]],L=_createForOfIteratorHelper(S.keys());try{for(L.s();!(F=L.n()).done;)B=F.value,(N=S.get(B)||0)>0&&A.push([B,N])}catch(e){L.e(e)}finally{L.f()}return e.n=4,t.sync();case 4:for(G=A.map((function(e){return e[0]})),U=A.map((function(e){return[e[1]]})),console.log("Required Amounts",U),H=[],P=[],W=0;W<G.length;W++){for(j=String(G[W]).trim(),q=!1,Q=0;Q<b.values.length;Q++)J=String(b.values[Q][0]).trim(),V=String(w.values[Q][0]).trim(),z=Number(D.values[Q][0]),j===J&&(K=V.includes("MEB"),X=V.includes("EFW"),H.push([j,K?z:0]),P.push([j,X?z:0]),q=!0);q||(H.push([j,0]),P.push([j,0]))}return e.n=5,t.sync();case 5:Y=buildSumMap(H.map((function(e){return[e[0]]})),H.map((function(e){return[e[1]]}))),$=Array.from(Y.entries()).map((function(e){return[e[1]]})),Z=buildSumMap(P.map((function(e){return[e[0]]})),P.map((function(e){return[e[1]]}))),ee=Array.from(Z.entries()).map((function(e){return[e[1]]})),te=$.map((function(e,t){return Number(e)+ee[t][0]})),ne=buildSumMap(M.values,k.values),re=[["On Order"]],ae=_createForOfIteratorHelper(G.slice(1));try{for(ae.s();!(oe=ae.n()).done;)ce=oe.value,ue=ne.get(ce)||0,re.push([ue])}catch(e){ae.e(e)}finally{ae.f()}for(se=[["Earliest Start Date"]],le=[["Release Date"]],ie=1;ie<G.length;ie++)ge=String(G[ie]).trim(),de=String(startDateMap.get(ge))||"No Start Date Established",fe=de.split(" ").slice(0,4).join(" "),se.push([fe]),me=new Date(de),isNaN(me)?le.push(["Invalid Release Date"]):(me.setDate(me.getDate()-10),ye=me.toDateString(),le.push([ye]));for(Re=U.slice(1).map((function(e,t){return Number(e)-$[t]})),(pe=[]).push({caseNumber:"Case #",demand:"Demand",mebQty:"Qty MEB",efwQty:"Qty EFW",totalQty:"Total MEB + EFW",onOrder:"On Order",startDate:"Start Date",releaseDate:"Release Date",qtyNeeded:"Qty Needed (MEB)",notes:"Notes"}),he=0;he<G.slice(1).length;he++)Re[he]>0&&pe.push({caseNumber:G[he+1],demand:U[he+1][0],mebQty:$[he][0],efwQty:ee[he][0],totalQty:te[he],onOrder:re[he+1][0],startDate:se[he+1][0],releaseDate:le[he+1][0],qtyNeeded:Re[he],notes:""});return pe.length>1&&(ve=pe.map((function(e){return[e.caseNumber]})),Ce=pe.map((function(e){return[e.demand]})),_e=pe.map((function(e){return[e.mebQty]})),Oe=pe.map((function(e){return[e.efwQty]})),Ie=pe.map((function(e){return[e.totalQty]})),be=pe.map((function(e){return[e.onOrder]})),De=pe.map((function(e){return[e.startDate]})),we=pe.map((function(e){return[e.releaseDate]})),Te=pe.map((function(e){return[e.qtyNeeded]})),Me=pe.map((function(e){return[e.notes]})),s.getRange("A1:A".concat(ve.length)).values=ve,s.getRange("B1:B".concat(Ce.length)).values=Ce,s.getRange("C1:C".concat(_e.length)).values=_e,s.getRange("D1:D".concat(Oe.length)).values=Oe,s.getRange("E1:E".concat(Ie.length)).values=Ie,s.getRange("F1:F".concat(be.length)).values=be,s.getRange("G1:G".concat(De.length)).values=De,s.getRange("H1:H".concat(we.length)).values=we,s.getRange("I1:I".concat(Te.length)).values=Te,s.getRange("J1:J".concat(Me.length)).values=Me),e.n=6,t.sync();case 6:return s.getRange("A:J").format.autofitColumns(),s.getRange("A:J").format.horizontalAlignment="Center",s.getRange("A:J").format.verticalAlignment="Center",s.getRange("C:C").numberFormat=[["General"]],s.getRange("A:A").format.columnWidth=120,s.getRange("B:B").format.columnWidth=70,s.getRange("C:C").format.columnWidth=70,s.getRange("D:D").format.columnWidth=70,s.getRange("E:E").format.columnWidth=100,s.getRange("F:F").format.columnWidth=75,s.getRange("G:G").format.columnWidth=90,s.getRange("H:H").format.columnWidth=90,s.getRange("I:I").format.columnWidth=130,s.getRange("J:J").format.columnWidth=150,s.getUsedRange().format.rowHeight=20,s.freezePanes.freezeRows(1),s.getRange("I1:I1").format.fill.color="#00008B",s.getRange("I1:I1").format.font.color="yellow",ke=s.getUsedRange(),Ee=ke.format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight","InsideVertical","InsideHorizontal"].forEach((function(e){Ee.getItem(e).style="Continuous",Ee.getItem(e).weight="Thin",Ee.getItem(e).color="#000000"})),xe=pe.length,Se=s.getRange("I1:I".concat(xe)).format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight"].forEach((function(e){Se.getItem(e).style="Continuous",Se.getItem(e).weight="Thick",Se.getItem(e).color="#00008B"})),e.n=7,t.sync();case 7:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_importOtherColumnData.apply(this,arguments)}function readoutData(){return _readoutData.apply(this,arguments)}function _readoutData(){return _readoutData=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,a,o,c,u,s,l,i,g,d,f,m,y,R,p,h,v,C,_,O,I,b,D,w,T,M,k,E,x,S,A,L,F,B,N,G,U,H,P,W,j,q,Q,J,V,z,K,X,Y,$,Z,ee,te,ne,re,ae,oe,ce,ue,se,le,ie,ge,de;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getItem("Inventory At"),r=n.getUsedRange().load("values"),a=t.workbook.worksheets.getItem("Inventory"),o=a.getUsedRange().load("values"),c=t.workbook.worksheets.getItem("Inventory Request"),e.n=1,t.sync();case 1:return u=r.values[0],s=u.indexOf("Case #"),l=u.indexOf("Qty Needed (MEB)"),i=u.indexOf("Qty EFW"),g="".concat(colIdxToLetter(s),":").concat(colIdxToLetter(s)),d="".concat(colIdxToLetter(l),":").concat(colIdxToLetter(l)),f="".concat(colIdxToLetter(i),":").concat(colIdxToLetter(i)),m=o.values[0],y=m.indexOf("Item Code"),R=m.indexOf("Inventory Date"),p=m.indexOf("Inventory Ref"),h=m.indexOf("Inventory Qty"),v=m.indexOf("Location"),C="".concat(colIdxToLetter(y),":").concat(colIdxToLetter(y)),_="".concat(colIdxToLetter(R),":").concat(colIdxToLetter(R)),O="".concat(colIdxToLetter(p),":").concat(colIdxToLetter(p)),I="".concat(colIdxToLetter(h),":").concat(colIdxToLetter(h)),b="".concat(colIdxToLetter(v),":").concat(colIdxToLetter(v)),e.n=2,t.sync();case 2:return D=n.getRange(g).getUsedRange().load("values"),w=n.getRange(d).getUsedRange().load("values"),T=n.getRange(f).getUsedRange().load("values"),M=a.getRange(C).getUsedRange().load("values"),k=a.getRange(_).getUsedRange().load("values"),E=a.getRange(O).getUsedRange().load("values"),x=a.getRange(I).getUsedRange().load("values"),S=a.getRange(b).getUsedRange().load("values"),e.n=3,t.sync();case 3:for(A=[],L=1;L<D.values.length;L++)F=Number(w.values[L][0]),B=Number(T.values[L][0]),F>300&&B>0&&A.push({itemCode:String(D.values[L][0]).trim(),qtyNeeded:F});for(N=new Map,G=1;G<M.values.length;G++)U=String(M.values[G][0]).trim(),H=k.values[G]?String(k.values[G][0]).trim():"",(P=ExcelDateToJSDate(H)).setHours(0,0,0,0),W=formatDate(P),j=S.values[G]?String(S.values[G][0]).trim():"",q=E.values[G]?String(E.values[G][0]).trim():"",Q=Number(x.values[G][0]),j.includes("EFW")&&U&&!isNaN(Q)&&Q>0&&(N.has(U)||N.set(U,[]),N.get(U).push({date:W,ref:q,qty:Q}));J=_createForOfIteratorHelper(N);try{for(J.s();!(V=J.n()).done;)(z=_slicedToArray(V.value,2))[0],z[1].sort((function(e,t){return new Date(e.date)-new Date(t.date)}))}catch(e){J.e(e)}finally{J.f()}K=[["Item Code","Inventory Date","Inventory Ref","Inventory Qty"]],X=0,Y=A;case 4:if(!(X<Y.length)){e.n=13;break}if($=Y[X],Z=$.itemCode,ee=$.qtyNeeded,!N.has(Z)){e.n=12;break}te=N.get(Z),ne=0,re=_createForOfIteratorHelper(te),e.p=5,re.s();case 6:if((ae=re.n()).done){e.n=9;break}if(oe=ae.value,!(ne>=ee)){e.n=7;break}return e.a(3,9);case 7:K.push([Z,oe.date,oe.ref,oe.qty]),ne+=oe.qty;case 8:e.n=6;break;case 9:e.n=11;break;case 10:e.p=10,de=e.v,re.e(de);case 11:return e.p=11,re.f(),e.f(11);case 12:X++,e.n=4;break;case 13:return K.length>1&&(ce=K.map((function(e){return[e[0]]})),ue=K.map((function(e){return[e[1]]})),se=K.map((function(e){return[e[2]]})),le=K.map((function(e){return[e[3]]})),c.getRange("A1:A".concat(ce.length)).values=ce,c.getRange("B1:B".concat(ue.length)).values=ue,c.getRange("C1:C".concat(se.length)).values=se,c.getRange("D1:D".concat(le.length)).values=le),e.n=14,t.sync();case 14:return c.getRange("A:D").format.autofitColumns(),c.getRange("A:D").format.horizontalAlignment="Center",c.getRange("A:D").format.verticalAlignment="Center",c.getRange("A:A").format.columnWidth=120,c.getRange("B:B").format.columnWidth=100,c.getRange("C:C").format.columnWidth=100,c.getRange("D:D").format.columnWidth=100,c.getUsedRange().format.rowHeight=20,c.freezePanes.freezeRows(1),ie=c.getUsedRange(),ge=ie.format.borders,["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight","InsideVertical","InsideHorizontal"].forEach((function(e){ge.getItem(e).style="Continuous",ge.getItem(e).weight="Thin",ge.getItem(e).color="#000000"})),e.n=15,t.sync();case 15:return e.a(2)}}),e,null,[[5,10,11,12]])})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_readoutData.apply(this,arguments)}function resetGenerateOrdering(){return _resetGenerateOrdering.apply(this,arguments)}function _resetGenerateOrdering(){return _resetGenerateOrdering=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.getItemOrNullObject("Ordering").delete(),filter=[],earlyDateMap.clear(),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_resetGenerateOrdering.apply(this,arguments)}function resetGenerateInventory(){return _resetGenerateInventory.apply(this,arguments)}function _resetGenerateInventory(){return _resetGenerateInventory=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return(n=t.workbook.worksheets).getItemOrNullObject("Inventory At").delete(),n.getItemOrNullObject("Inventory Request").delete(),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_resetGenerateInventory.apply(this,arguments)}function colIdxToLetter(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}function buildSumMap(e,t){for(var n=new Map,r=1;r<e.length;r++){var a=e[r][0],o=Number(t[r][0]);a&&!isNaN(o)&&n.set(a,(n.get(a)||0)+o)}return n}function dateFilter(){return _dateFilter.apply(this,arguments)}function _dateFilter(){return _dateFilter=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,a,o,c,u,s,l,i,g,d,f,m,y,R,p,h,v,C,_,O,I,b,D,w,T,M,k,E,x,S,A,L,F,B,N,G,U;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=document.getElementById("start-date").value,r=document.getElementById("end-date").value,a=inputDateParse(n),o=inputDateParse(r),c=t.workbook.worksheets.getItem("Dynamic"),u=c.getUsedRange().load("values"),e.n=1,t.sync();case 1:return s=u.values[0],l=s.indexOf("Corrugate"),i=s.indexOf("Planned Start"),g=s.indexOf("Number of Corrugate"),d=s.indexOf("Order Number"),f="".concat(colIdxToLetter(i),":").concat(colIdxToLetter(i)),m="".concat(colIdxToLetter(g),":").concat(colIdxToLetter(g)),y="".concat(colIdxToLetter(l),":").concat(colIdxToLetter(l)),R="".concat(colIdxToLetter(d),":").concat(colIdxToLetter(d)),p=t.workbook.worksheets.getItem("Dynamic"),h=p.getRange(y).getUsedRange().load("values"),v=p.getRange(m).getUsedRange().load("values"),C=c.getRange(f).getUsedRange().load("values"),_=c.getRange(R).getUsedRange().load("values"),e.n=2,t.sync();case 2:for(O=new Map,I=1;I<h.values.length;I++)b=String(h.values[I][0]).trim(),D=C.values[I]?String(C.values[I][0]).trim():"",(w=ExcelDateToJSDate(D)).setHours(0,0,0,0),T=String(_.values[I][0]).trim(),M=Number(v.values[I][0]),b&&w>=a&&w<=o&&(!O.has(T)||w>O.get(T).date)&&O.set(T,{itemCode:b,qty:M,date:w,job:T});filter=Array.from(O.values()),earlyDateMap.clear(),k=_createForOfIteratorHelper(filter);try{for(k.s();!(E=k.n()).done;)x=E.value,S=x.itemCode,A=x.date,(!earlyDateMap.has(S)||A<earlyDateMap.get(S))&&earlyDateMap.set(S,A)}catch(e){k.e(e)}finally{k.f()}return filter.sort((function(e,t){return e.date-t.date})),e.n=3,t.sync();case 3:for(L=1;L<h.values.length;L++)F=String(h.values[L][0]).trim(),B=C.values[L]?String(C.values[L][0]).trim():"",(N=ExcelDateToJSDate(B)).setHours(0,0,0,0),G=String(_.values[L][0]).trim(),U=Number(v.values[L][0]),F&&allData.push({itemCode:F,qty:U,job:G,date:N});case 4:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_dateFilter.apply(this,arguments)}function otherDateFilter(){return _otherDateFilter.apply(this,arguments)}function _otherDateFilter(){return _otherDateFilter=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,a,o,c,u,s,l,i,g,d,f,m,y,R,p,h,v,C,_,O,I,b,D,w,T,M,k,E,x,S,A;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=document.getElementById("start-date").value,r=document.getElementById("end-date").value,a=inputDateParse(n),o=inputDateParse(r),c=t.workbook.worksheets.getItem("Dynamic"),u=c.getUsedRange().load("values"),e.n=1,t.sync();case 1:return s=u.values[0],l=s.indexOf("Corrugate"),i=s.indexOf("Planned Start"),g=s.indexOf("Number of Corrugate"),d=s.indexOf("Order Number"),f="".concat(colIdxToLetter(i),":").concat(colIdxToLetter(i)),m="".concat(colIdxToLetter(g),":").concat(colIdxToLetter(g)),y="".concat(colIdxToLetter(l),":").concat(colIdxToLetter(l)),R="".concat(colIdxToLetter(d),":").concat(colIdxToLetter(d)),p=t.workbook.worksheets.getItem("Dynamic"),h=p.getRange(y).getUsedRange().load("values"),v=p.getRange(m).getUsedRange().load("values"),C=c.getRange(f).getUsedRange().load("values"),_=c.getRange(R).getUsedRange().load("values"),e.n=2,t.sync();case 2:for(O=new Map,I=1;I<h.values.length;I++)b=String(h.values[I][0]).trim(),D=C.values[I]?String(C.values[I][0]).trim():"",(w=ExcelDateToJSDate(D)).setHours(0,0,0,0),T=String(_.values[I][0]).trim(),M=Number(v.values[I][0]),b&&w>=a&&w<=o&&(!O.has(T)||w>O.get(T).date)&&O.set(T,{itemCode:b,qty:M,date:w,job:T});invFilter=Array.from(O.values()),startDateMap.clear(),k=_createForOfIteratorHelper(invFilter);try{for(k.s();!(E=k.n()).done;)x=E.value,S=x.itemCode,A=x.date,(!startDateMap.has(S)||A<startDateMap.get(S))&&startDateMap.set(S,A)}catch(e){k.e(e)}finally{k.f()}return invFilter.sort((function(e,t){return e.date-t.date})),e.n=3,t.sync();case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_otherDateFilter.apply(this,arguments)}function inputDateParse(e){var t=_slicedToArray(e.split("-").map(Number),3),n=t[0],r=t[1],a=t[2];return new Date(n,r-1,a)}function ExcelDateToJSDate(e){var t=new Date(86400*(e-25569)*1e3);return new Date(t.getTime()+6e4*t.getTimezoneOffset())}function checkDatesAndClearMessage(){var e=document.getElementById("start-date").value,t=document.getElementById("end-date").value;e&&t&&(document.getElementById("message-area").textContent="")}function displayData(e){return _displayData.apply(this,arguments)}function _displayData(){return _displayData=_asyncToGenerator(_regenerator().m((function e(t){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(n){var r,a,o,c,u,s,l,i,g,d,f,m,y,R,p,h,v;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return r=n.workbook.worksheets.getItem("Ordering"),(a=r.getRange(t.address)).load(["columnIndex","values","address"]),e.n=1,n.sync();case 1:if(console.log("Index Number",a.columnIndex),outputJobs.clear(),0!=a.columnIndex){e.n=9;break}return matchingData.length=0,o=a.values[0],c=allData.map((function(e){return[e.itemCode]})),u=allData.map((function(e){return[e.job]})),s=allData.map((function(e){return[e.qty]})),l=allData.map((function(e){return[e.date]})),i=r.tables.getItem("OrderingTable"),g=i.getDataBodyRange().load("values"),d=i.getHeaderRowRange().load("values"),e.n=2,n.sync();case 2:f=d.values[0],m=f.indexOf("Case #"),y=f.indexOf("Current Inventory"),R=0,p=0;case 3:if(!(p<g.values.length)){e.n=5;break}if(String(g.values[p][m]).trim()!==o[0]){e.n=4;break}return R=Number(g.values[p][y])||0,e.a(3,5);case 4:p++,e.n=3;break;case 5:localStorage.setItem("currentInventory",R),h=_regenerator().m((function e(){var t,n,r,a,i,g,d;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:t=c[v][0],n=u[v][0],r=s[v][0],a=l[v][0],i=formatDate(a),o==t&&(outputJobs.has(n)?(g=earlyDateMap.get(t),-1!==(d=matchingData.findIndex((function(e){return e.job===n&&e.code===t})))&&(matchingData[d].date=g)):(matchingData.push({code:t,job:n,qty:r,fDate:i,date:a}),outputJobs.add(n)));case 1:return e.a(2)}}),e)})),v=0;case 6:if(!(v<c.length)){e.n=8;break}return e.d(_regeneratorValues(h()),7);case 7:v++,e.n=6;break;case 8:console.log("intial finding of Matching Data",matchingData),handleCellChange([].concat(matchingData)),matchingData.sort((function(e,t){return e.date-t.date})),localStorage.setItem("matchingData",JSON.stringify(matchingData)),e.n=10;break;case 9:console.log("Not in range");case 10:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_displayData.apply(this,arguments)}function filteringDropdown(){return _filteringDropdown.apply(this,arguments)}function _filteringDropdown(){return _filteringDropdown=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,a,o,c,u,s,l,i,g,d,f,m,y,R,p;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getItem("Ordering"),r=n.tables.getItem("OrderingTable"),a=r.columns.getItem("Required Amount").filter,o=r.columns.getItem("Buy or Make").filter,c={CORS522_DW:180,"CORCTD0033A-R2":300,"COR2503503R0 RDC":250,"COR2320-4731":350,COR16M006405:350,"COR6064-RDC":445,CORM30402_C:310,"CORM37238 FLUTED DIV":500,CORM30403_C:250,"CORM39142-R1":250,CORM37912:300,CORX14107:300,"COR2320-4819-R1":300,"COR2320-4658-R1":250,COR17M001501:300,COR2320_5453:300,"COR2320-1840-R1":300,"COR2320-5573":400,COR2320_5575_R1:349,COR2320_5455:300,"COR2866 RDC":250,"COR6062 RDC":250,COR2320_5635:250,"COR6070 RDC":250,CORM33989_H_R2:283,CORMPS13185:250,COR18M020101:400,CORX14151_B:250,COR11707_R1:250,CORM38150_R1:250,COR2320_5906:199,COR17M013701_R1:197,"COR5537 PAD":273,CORM36590_ERECTED_R2:250,CORF170286A9:340,"CORF170287A7-R1":307,CORF170313A6:274,COR6052:250,COR2306R0:285,CORM37798_C_R1:185,COR2320_6830_R1:325,COR19M001713:300,"CORERECTOR-DW":207,COR19M001712_R1:192,CORMPS13113C_R1:200,CORL9466A4_M:258,COR2349R2_R1:300,CORMPS13182A_R1:300,CORDRF_L8916A1:210,COR19M001702_R1:404,CORL10648A2:300,CORDRF_6171_A:257,COR132790_2i:264,CORDRF_2037:271,CORDRF_2232:300,COR2251R0_R1:300,CORM38149_R1:375,COR19M012303:375,COR19M012304:305,COR20M023301:300,COR20M007911:186,"CORM34795_NO INSERT HSC LID":975,"CORM34795_NO INSERT HSC":975,COR20M018813:201,COR20M018814:278,CORDRF_2884_B:350,CORDRF_L9681A2:218,COR20M018815_R1:186,"COR15NF011001-R1":277,COR20M026410_R1:332,COR2320_5691:305,"COR16NF0805.03":305,COR2533504A_R1:320,COR16M006404_R1:269,COR18M010901:315,COR20M018812:257,COR18M025708:325,"CORM37238 GLORD SLEEVE_R1":275,CORABBOTT_CAP:138,CORABBOTT_SLV:109,COR19M010308:325,COR2320_7148_R2:263,COR16M006402:288,COR18M005551_R2:367,COR21M022706:323,COR17M017101_R1:227,CORM36342:200,COR19M019402_R1:304,COR16M006403:244,COR20M026401_R1:350,COR20M026402:363,COR20M026418:237,"COR18M005551_R3 NR":350,COR20M016311_R3:216,"CORM34795 RSC":385,CORM38164:450,COR19M019401_R1:300,COR19M019402_R2:300,CORM34084_A:188,COR2320_6257_R2:303,COR18M000117:202,CORM21854_A:340,COR2320_5582_R1:375,COR21M012001:417,COR16M002106:330,COR16M006401_R1:282,COR16M000901_R3:238,COR17M022101_R2:223,CORM41161_B:297,COR23M012203:261,CORL14795A1:203,CORL9486A1:279,COR18M025707_R2:265,CORF210335A4:296,"COR23LG0002.01":316,COR23M016803:300,CORL11558A4_M:272,CORM33618_B:241,"COR17CL0236.03":350,CORCSK11804A:282,"TB008-01":500,"T22925-5":800,"CORM37238 CAP":154,CORCSK11317B:221,CORL12394A1:266,CORMPS13215C:231,COR13442M:330,"COR21LG0020.01":305,CORMPS13117J:200,CORM38149_R2:245,CORM34795_INSERT_48:768,CORL14798A1:191,"COR20PF0474.02":315,COR16M002105_R1:350,"COR21LG0002.01":200,"CORCSK12007.02_R1":315,COR22M023719:283,CORMPS13048:340,CORMPS13150:405,COR16M006405_R1:256,COR17M027920_R2:340,CORM34795_INSERT_48_R1:625,COR23M014207:310,"CORM33393_E ERECTED":187,CORM26788_C_R2:276,COR20M017216:195,"COR22PF0925.07":347,CORMPS13145B:198,"COR22PF0834.01_R1":264,"COR24LG0016.04":313,"COR24LG0016.02_R1":334,"COR24LG0007.01":261,CORL9184A1_R1:349,COR22M009502_R1:295,"COR22PF0924.07":301,COR17M017101_R3:349,COR22M009501:296,COR22M009503:186,CORDRF_L9680A3:209,CORMPS13150_R1:370,CORMPS13004:465,COR22M009501_R1:292},e.n=1,t.sync();case 1:p=document.getElementById("order-filtering").value,e.n="Intial"===p?2:"cor-minimum"===p?3:"over-300"===p?6:"Must-buy"===p?7:"Can-buy"===p?8:"Can-make"===p?9:10;break;case 2:return console.log("no changes made"),a.clear(),o.clear(),r.columns.getItem("Case #").filter.clear(),e.a(3,11);case 3:return a.clear(),o.clear(),u=r.getDataBodyRange().load("values"),e.n=4,t.sync();case 4:return s=r.getHeaderRowRange().load("values"),e.n=5,t.sync();case 5:for(l=s.values[0],i=l.indexOf("Case #"),g=l.indexOf("Required Amount"),d=[],f=0;f<u.values.length;f++)m=String(u.values[f][i]).trim(),y=Number(u.values[f][g]),void 0!==(R=c[m])&&y>=R&&d.push(m);return r.columns.getItem("Case #").filter.applyValuesFilter(d),e.a(3,11);case 6:return a.clear(),o.clear(),r.columns.getItem("Case #").filter.clear(),a.applyCustomFilter(">=300"),e.a(3,11);case 7:return a.clear(),o.clear(),r.columns.getItem("Case #").filter.clear(),o.applyValuesFilter(["Must Buy"]),e.a(3,11);case 8:return a.clear(),o.clear(),r.columns.getItem("Case #").filter.clear(),o.applyValuesFilter(["Can Buy"]),e.a(3,11);case 9:return a.clear(),o.clear(),r.columns.getItem("Case #").filter.clear(),o.applyValuesFilter(["Can Make"]),e.a(3,11);case 10:return console.log("No valid filter selected"),e.a(3,11);case 11:return e.n=12,t.sync();case 12:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_filteringDropdown.apply(this,arguments)}function invFilteringDropdown(){return _invFilteringDropdown.apply(this,arguments)}function _invFilteringDropdown(){return _invFilteringDropdown=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,a,o;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:n=t.workbook.worksheets.getItem("Inventory At"),r=n.tables.getItem("InventoryAtTable"),a=r.columns.getItem("Qty Needed (MEB)").filter,o=document.getElementById("inventory-filtering").value,e.n="Intial case"===o?1:"over-300"===o?2:3;break;case 1:return console.log("no changes made"),a.clear(),e.a(3,4);case 2:return a.clear(),a.applyCustomFilter(">=300"),e.a(3,4);case 3:return console.log("No valid filter selected"),e.a(3,4);case 4:return e.n=5,t.sync();case 5:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_invFilteringDropdown.apply(this,arguments)}function formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-")}function test(){return _test.apply(this,arguments)}function _test(){return _test=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,a,o,c,u;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return(n=t.workbook.worksheets).load("items/name"),e.n=1,t.sync();case 1:r=n.items.filter((function(e){return["Sheet1","Sheet2","Sheet3"].includes(e.name)})),a=_createForOfIteratorHelper(r),e.p=2,c=_regenerator().m((function e(){var r,a,c,u,s,l,i;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return r=o.value,(a=n.getItem(r.name)).load("name"),e.n=1,t.sync();case 1:return(c=a.getUsedRangeOrNullObject()).load("values"),e.n=2,t.sync();case 2:if(c.values&&0!==c.values.length){e.n=3;break}return e.a(2,1);case 3:if(u=c.values[0].map((function(e){return String(e).trim().toLowerCase()})),s=null,u.includes("item code")&&u.includes("inventory qty")&&u.includes("location")&&u.includes("inventory date")?s="INVENTORY":u.includes("work center")&&u.includes("planned start")&&u.includes("corrugate")&&u.includes("number of corrugate")?s="DYNAMIC":u.includes("item code")&&u.includes("outstanding qty")&&(s="OPEN PO'S"),!s||a.name===s){e.n=4;break}if(n.items.some((function(e){return e.name===s}))){for(l=2,i="".concat(s," (").concat(l,")");n.items.some((function(e){return e.name===i}));)l++,i="".concat(s," (").concat(l,")");a.name=i}else a.name=s;return e.n=4,t.sync();case 4:return e.a(2)}}),e)})),a.s();case 3:if((o=a.n()).done){e.n=6;break}return e.d(_regeneratorValues(c()),4);case 4:if(!e.v){e.n=5;break}return e.a(3,5);case 5:e.n=3;break;case 6:e.n=8;break;case 7:e.p=7,u=e.v,a.e(u);case 8:return e.p=8,a.f(),e.f(8);case 9:return e.a(2)}}),e,null,[[2,7,8,9]])})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}}),e)}))),_test.apply(this,arguments)}